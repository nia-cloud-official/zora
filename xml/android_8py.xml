<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.11.0" xml:lang="en-US">
  <compounddef id="android_8py" kind="file" language="Python">
    <compoundname>android.py</compoundname>
    <innerclass refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer" prot="public">gyp::generator::android::AndroidMkWriter</innerclass>
    <innernamespace refid="namespacegyp">gyp</innernamespace>
    <innernamespace refid="namespacegyp_1_1generator">gyp::generator</innernamespace>
    <innernamespace refid="namespacegyp_1_1generator_1_1android">gyp::generator::android</innernamespace>
    <briefdescription>
    </briefdescription>
    <detaileddescription>
    </detaileddescription>
    <programlisting>
<codeline lineno="1" refid="namespacegyp_1_1generator_1_1android" refkind="compound"><highlight class="comment">#<sp/>Copyright<sp/>(c)<sp/>2012<sp/>Google<sp/>Inc.<sp/>All<sp/>rights<sp/>reserved.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2"><highlight class="normal"></highlight><highlight class="comment">#<sp/>Use<sp/>of<sp/>this<sp/>source<sp/>code<sp/>is<sp/>governed<sp/>by<sp/>a<sp/>BSD-style<sp/>license<sp/>that<sp/>can<sp/>be</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3"><highlight class="normal"></highlight><highlight class="comment">#<sp/>found<sp/>in<sp/>the<sp/>LICENSE<sp/>file.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4"><highlight class="normal"></highlight></codeline>
<codeline lineno="5"><highlight class="normal"></highlight><highlight class="comment">#<sp/>Notes:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6"><highlight class="normal"></highlight><highlight class="comment">#</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7"><highlight class="normal"></highlight><highlight class="comment">#<sp/>This<sp/>generates<sp/>makefiles<sp/>suitable<sp/>for<sp/>inclusion<sp/>into<sp/>the<sp/>Android<sp/>build<sp/>system</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="8"><highlight class="normal"></highlight><highlight class="comment">#<sp/>via<sp/>an<sp/>Android.mk<sp/>file.<sp/>It<sp/>is<sp/>based<sp/>on<sp/>make.py,<sp/>the<sp/>standard<sp/>makefile</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="9"><highlight class="normal"></highlight><highlight class="comment">#<sp/>generator.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="10"><highlight class="normal"></highlight><highlight class="comment">#</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="11"><highlight class="normal"></highlight><highlight class="comment">#<sp/>The<sp/>code<sp/>below<sp/>generates<sp/>a<sp/>separate<sp/>.mk<sp/>file<sp/>for<sp/>each<sp/>target,<sp/>but</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="12"><highlight class="normal"></highlight><highlight class="comment">#<sp/>all<sp/>are<sp/>sourced<sp/>by<sp/>the<sp/>top-level<sp/>GypAndroid.mk.<sp/><sp/>This<sp/>means<sp/>that<sp/>all</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="13"><highlight class="normal"></highlight><highlight class="comment">#<sp/>variables<sp/>in<sp/>.mk-files<sp/>clobber<sp/>one<sp/>another,<sp/>and<sp/>furthermore<sp/>that<sp/>any</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="14"><highlight class="normal"></highlight><highlight class="comment">#<sp/>variables<sp/>set<sp/>potentially<sp/>clash<sp/>with<sp/>other<sp/>Android<sp/>build<sp/>system<sp/>variables.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="15"><highlight class="normal"></highlight><highlight class="comment">#<sp/>Try<sp/>to<sp/>avoid<sp/>setting<sp/>global<sp/>variables<sp/>where<sp/>possible.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="16"><highlight class="normal"></highlight></codeline>
<codeline lineno="17"><highlight class="normal"></highlight></codeline>
<codeline lineno="18"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>gyp</highlight></codeline>
<codeline lineno="19"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespacegyp_1_1common" kindref="compound">gyp.common</ref></highlight></codeline>
<codeline lineno="20"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespacegyp_1_1generator_1_1make" kindref="compound">gyp.generator.make</ref><sp/></highlight><highlight class="keyword">as</highlight><highlight class="normal"><sp/>make<sp/><sp/></highlight><highlight class="comment">#<sp/>Reuse<sp/>global<sp/>functions<sp/>from<sp/>make<sp/>backend.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="21"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>os</highlight></codeline>
<codeline lineno="22"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>re</highlight></codeline>
<codeline lineno="23"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>subprocess</highlight></codeline>
<codeline lineno="24"><highlight class="normal"></highlight></codeline>
<codeline lineno="25" refid="namespacegyp_1_1generator_1_1android_1ad9f8d65028f4baf230f56ce5cb1efb2a" refkind="member"><highlight class="normal">generator_default_variables<sp/>=<sp/>{</highlight></codeline>
<codeline lineno="26"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;OS&quot;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&quot;android&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="27"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;EXECUTABLE_PREFIX&quot;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&quot;&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="28"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;EXECUTABLE_SUFFIX&quot;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&quot;&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="29"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;STATIC_LIB_PREFIX&quot;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&quot;lib&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="30"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;SHARED_LIB_PREFIX&quot;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&quot;lib&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="31"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;STATIC_LIB_SUFFIX&quot;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&quot;.a&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="32"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;SHARED_LIB_SUFFIX&quot;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&quot;.so&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="33"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;INTERMEDIATE_DIR&quot;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&quot;$(gyp_intermediate_dir)&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="34"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;SHARED_INTERMEDIATE_DIR&quot;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&quot;$(gyp_shared_intermediate_dir)&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="35"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;PRODUCT_DIR&quot;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&quot;$(gyp_shared_intermediate_dir)&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="36"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;SHARED_LIB_DIR&quot;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&quot;$(builddir)/lib.$(TOOLSET)&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="37"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;LIB_DIR&quot;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&quot;$(obj).$(TOOLSET)&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="38"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;RULE_INPUT_ROOT&quot;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&quot;%(INPUT_ROOT)s&quot;</highlight><highlight class="normal">,<sp/><sp/></highlight><highlight class="comment">#<sp/>This<sp/>gets<sp/>expanded<sp/>by<sp/>Python.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="39"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;RULE_INPUT_DIRNAME&quot;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&quot;%(INPUT_DIRNAME)s&quot;</highlight><highlight class="normal">,<sp/><sp/></highlight><highlight class="comment">#<sp/>This<sp/>gets<sp/>expanded<sp/>by<sp/>Python.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="40"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;RULE_INPUT_PATH&quot;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&quot;$(RULE_SOURCES)&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="41"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;RULE_INPUT_EXT&quot;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&quot;$(suffix<sp/>$&lt;)&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="42"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;RULE_INPUT_NAME&quot;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&quot;$(notdir<sp/>$&lt;)&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="43"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;CONFIGURATION_NAME&quot;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&quot;$(GYP_CONFIGURATION)&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="44"><highlight class="normal">}</highlight></codeline>
<codeline lineno="45"><highlight class="normal"></highlight></codeline>
<codeline lineno="46"><highlight class="normal"></highlight><highlight class="comment">#<sp/>Make<sp/>supports<sp/>multiple<sp/>toolsets</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="47" refid="namespacegyp_1_1generator_1_1android_1ac52cd6ecb5cedd2bd38b3ad46ff3e72c" refkind="member"><highlight class="normal">generator_supports_multiple_toolsets<sp/>=<sp/></highlight><highlight class="keyword">True</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="48"><highlight class="normal"></highlight></codeline>
<codeline lineno="49"><highlight class="normal"></highlight></codeline>
<codeline lineno="50"><highlight class="normal"></highlight><highlight class="comment">#<sp/>Generator-specific<sp/>gyp<sp/>specs.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="51" refid="namespacegyp_1_1generator_1_1android_1a96c7dbd555e5ee620820bbb3b720aab6" refkind="member"><highlight class="normal">generator_additional_non_configuration_keys<sp/>=<sp/>[</highlight></codeline>
<codeline lineno="52"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>Boolean<sp/>to<sp/>declare<sp/>that<sp/>this<sp/>target<sp/>does<sp/>not<sp/>want<sp/>its<sp/>name<sp/>mangled.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="53"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;android_unmangled_name&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="54"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>Map<sp/>of<sp/>android<sp/>build<sp/>system<sp/>variables<sp/>to<sp/>set.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="55"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;aosp_build_settings&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="56"><highlight class="normal">]</highlight></codeline>
<codeline lineno="57" refid="namespacegyp_1_1generator_1_1android_1af2586faea25531ee36203e86aabc532c" refkind="member"><highlight class="normal">generator_additional_path_sections<sp/>=<sp/>[]</highlight></codeline>
<codeline lineno="58" refid="namespacegyp_1_1generator_1_1android_1a53556dabc354671a6be1bae6de5ea753" refkind="member"><highlight class="normal">generator_extra_sources_for_rules<sp/>=<sp/>[]</highlight></codeline>
<codeline lineno="59"><highlight class="normal"></highlight></codeline>
<codeline lineno="60"><highlight class="normal"></highlight></codeline>
<codeline lineno="61" refid="namespacegyp_1_1generator_1_1android_1af0aa0d726600c8d8f326e153c5ea992c" refkind="member"><highlight class="normal">ALL_MODULES_FOOTER<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;\</highlight></codeline>
<codeline lineno="62"><highlight class="stringliteral">#<sp/>&quot;gyp_all_modules&quot;<sp/>is<sp/>a<sp/>concatenation<sp/>of<sp/>the<sp/>&quot;gyp_all_modules&quot;<sp/>targets<sp/>from</highlight></codeline>
<codeline lineno="63"><highlight class="stringliteral">#<sp/>all<sp/>the<sp/>included<sp/>sub-makefiles.<sp/>This<sp/>is<sp/>just<sp/>here<sp/>to<sp/>clarify.</highlight></codeline>
<codeline lineno="64"><highlight class="stringliteral">gyp_all_modules:</highlight></codeline>
<codeline lineno="65"><highlight class="stringliteral">&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="66"><highlight class="normal"></highlight></codeline>
<codeline lineno="67" refid="namespacegyp_1_1generator_1_1android_1ada4b30dd6fcd54714cd0feacdf9af0a9" refkind="member"><highlight class="normal">header<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;\</highlight></codeline>
<codeline lineno="68"><highlight class="stringliteral">#<sp/>This<sp/>file<sp/>is<sp/>generated<sp/>by<sp/>gyp;<sp/>do<sp/>not<sp/>edit.</highlight></codeline>
<codeline lineno="69"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="70"><highlight class="stringliteral">&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="71"><highlight class="normal"></highlight></codeline>
<codeline lineno="72"><highlight class="normal"></highlight><highlight class="comment">#<sp/>Map<sp/>gyp<sp/>target<sp/>types<sp/>to<sp/>Android<sp/>module<sp/>classes.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="73" refid="namespacegyp_1_1generator_1_1android_1a53dba8f023139768afd0628043344d71" refkind="member"><highlight class="normal">MODULE_CLASSES<sp/>=<sp/>{</highlight></codeline>
<codeline lineno="74"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;static_library&quot;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&quot;STATIC_LIBRARIES&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="75"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;shared_library&quot;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&quot;SHARED_LIBRARIES&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="76"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;executable&quot;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&quot;EXECUTABLES&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="77"><highlight class="normal">}</highlight></codeline>
<codeline lineno="78"><highlight class="normal"></highlight></codeline>
<codeline lineno="79"><highlight class="normal"></highlight></codeline>
<codeline lineno="80" refid="namespacegyp_1_1generator_1_1android_1ad50d2d1fc93ec0e72637c4c4f60c1cc7" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="namespacegyp_1_1generator_1_1android_1ad50d2d1fc93ec0e72637c4c4f60c1cc7" kindref="member">IsCPPExtension</ref>(ext):</highlight></codeline>
<codeline lineno="81"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>make.COMPILABLE_EXTENSIONS.get(ext)<sp/>==<sp/></highlight><highlight class="stringliteral">&quot;cxx&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="82"><highlight class="normal"></highlight></codeline>
<codeline lineno="83"><highlight class="normal"></highlight></codeline>
<codeline lineno="84" refid="namespacegyp_1_1generator_1_1android_1a27b0bbc0fc0a6154ceebf7b4224fa7bf" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="namespacegyp_1_1generator_1_1android_1a27b0bbc0fc0a6154ceebf7b4224fa7bf" kindref="member">Sourceify</ref>(path):</highlight></codeline>
<codeline lineno="85"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Convert<sp/>a<sp/>path<sp/>to<sp/>its<sp/>source<sp/>directory<sp/>form.<sp/>The<sp/>Android<sp/>backend<sp/>does<sp/>not</highlight></codeline>
<codeline lineno="86"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>support<sp/>options.generator_output,<sp/>so<sp/>this<sp/>function<sp/>is<sp/>a<sp/>noop.&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="87"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>path</highlight></codeline>
<codeline lineno="88"><highlight class="normal"></highlight></codeline>
<codeline lineno="89"><highlight class="normal"></highlight></codeline>
<codeline lineno="90"><highlight class="normal"></highlight><highlight class="comment">#<sp/>Map<sp/>from<sp/>qualified<sp/>target<sp/>to<sp/>path<sp/>to<sp/>output.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="91"><highlight class="normal"></highlight><highlight class="comment">#<sp/>For<sp/>Android,<sp/>the<sp/>target<sp/>of<sp/>these<sp/>maps<sp/>is<sp/>a<sp/>tuple<sp/>(&apos;static&apos;,<sp/>&apos;modulename&apos;),</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="92"><highlight class="normal"></highlight><highlight class="comment">#<sp/>(&apos;dynamic&apos;,<sp/>&apos;modulename&apos;),<sp/>or<sp/>(&apos;path&apos;,<sp/>&apos;some/path&apos;)<sp/>instead<sp/>of<sp/>a<sp/>string,</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="93"><highlight class="normal"></highlight><highlight class="comment">#<sp/>since<sp/>we<sp/>link<sp/>by<sp/>module.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="94" refid="namespacegyp_1_1generator_1_1android_1a9904e3b4cda56c3fd16671a43e2242e5" refkind="member"><highlight class="normal">target_outputs<sp/>=<sp/>{}</highlight></codeline>
<codeline lineno="95"><highlight class="normal"></highlight><highlight class="comment">#<sp/>Map<sp/>from<sp/>qualified<sp/>target<sp/>to<sp/>any<sp/>linkable<sp/>output.<sp/><sp/>A<sp/>subset</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="96"><highlight class="normal"></highlight><highlight class="comment">#<sp/>of<sp/>target_outputs.<sp/><sp/>E.g.<sp/>when<sp/>mybinary<sp/>depends<sp/>on<sp/>liba,<sp/>we<sp/>want<sp/>to</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="97"><highlight class="normal"></highlight><highlight class="comment">#<sp/>include<sp/>liba<sp/>in<sp/>the<sp/>linker<sp/>line;<sp/>when<sp/>otherbinary<sp/>depends<sp/>on</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="98"><highlight class="normal"></highlight><highlight class="comment">#<sp/>mybinary,<sp/>we<sp/>just<sp/>want<sp/>to<sp/>build<sp/>mybinary<sp/>first.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="99" refid="namespacegyp_1_1generator_1_1android_1a6f7c9c6de5501f4c8c02ea11f8477940" refkind="member"><highlight class="normal">target_link_deps<sp/>=<sp/>{}</highlight></codeline>
<codeline lineno="100"><highlight class="normal"></highlight></codeline>
<codeline lineno="101"><highlight class="normal"></highlight></codeline>
<codeline lineno="102" refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer" kindref="compound">AndroidMkWriter</ref>:</highlight></codeline>
<codeline lineno="103"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;AndroidMkWriter<sp/>packages<sp/>up<sp/>the<sp/>writing<sp/>of<sp/>one<sp/>target-specific<sp/>Android.mk.</highlight></codeline>
<codeline lineno="104"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="105"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Its<sp/>only<sp/>real<sp/>entry<sp/>point<sp/>is<sp/>Write(),<sp/>and<sp/>is<sp/>mostly<sp/>used<sp/>for<sp/>namespacing.</highlight></codeline>
<codeline lineno="106"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="107"><highlight class="normal"></highlight></codeline>
<codeline lineno="108" refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1aa97c6fb3e8d6b4a580fda4d947cea295" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1aa97c6fb3e8d6b4a580fda4d947cea295" kindref="member">__init__</ref>(self,<sp/>android_top_dir):</highlight></codeline>
<codeline lineno="109" refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1a8931c4ee94ed3001fd856ffe00353a2e" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1a8931c4ee94ed3001fd856ffe00353a2e" kindref="member">android_top_dir</ref><sp/>=<sp/>android_top_dir</highlight></codeline>
<codeline lineno="110"><highlight class="normal"></highlight></codeline>
<codeline lineno="111" refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1a63ff918383cbe761c4a0e8c7b1ec95f3" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1a63ff918383cbe761c4a0e8c7b1ec95f3" kindref="member">Write</ref>(</highlight></codeline>
<codeline lineno="112"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self,</highlight></codeline>
<codeline lineno="113"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>qualified_target,</highlight></codeline>
<codeline lineno="114"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>relative_target,</highlight></codeline>
<codeline lineno="115"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>base_path,</highlight></codeline>
<codeline lineno="116"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>output_filename,</highlight></codeline>
<codeline lineno="117"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>spec,</highlight></codeline>
<codeline lineno="118"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>configs,</highlight></codeline>
<codeline lineno="119"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>part_of_all,</highlight></codeline>
<codeline lineno="120"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>write_alias_target,</highlight></codeline>
<codeline lineno="121"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sdk_version,</highlight></codeline>
<codeline lineno="122"><highlight class="normal"><sp/><sp/><sp/><sp/>):</highlight></codeline>
<codeline lineno="123"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;The<sp/>main<sp/>entry<sp/>point:<sp/>writes<sp/>a<sp/>.mk<sp/>file<sp/>for<sp/>a<sp/>single<sp/>target.</highlight></codeline>
<codeline lineno="124"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="125"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Arguments:</highlight></codeline>
<codeline lineno="126"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>qualified_target:<sp/>target<sp/>we&apos;re<sp/>generating</highlight></codeline>
<codeline lineno="127"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>relative_target:<sp/>qualified<sp/>target<sp/>name<sp/>relative<sp/>to<sp/>the<sp/>root</highlight></codeline>
<codeline lineno="128"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>base_path:<sp/>path<sp/>relative<sp/>to<sp/>source<sp/>root<sp/>we&apos;re<sp/>building<sp/>in,<sp/>used<sp/>to<sp/>resolve</highlight></codeline>
<codeline lineno="129"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>target-relative<sp/>paths</highlight></codeline>
<codeline lineno="130"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>output_filename:<sp/>output<sp/>.mk<sp/>file<sp/>name<sp/>to<sp/>write</highlight></codeline>
<codeline lineno="131"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>spec,<sp/>configs:<sp/>gyp<sp/>info</highlight></codeline>
<codeline lineno="132"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>part_of_all:<sp/>flag<sp/>indicating<sp/>this<sp/>target<sp/>is<sp/>part<sp/>of<sp/>&apos;all&apos;</highlight></codeline>
<codeline lineno="133"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>write_alias_target:<sp/>flag<sp/>indicating<sp/>whether<sp/>to<sp/>create<sp/>short<sp/>aliases<sp/>for</highlight></codeline>
<codeline lineno="134"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>this<sp/>target</highlight></codeline>
<codeline lineno="135"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sdk_version:<sp/>what<sp/>to<sp/>emit<sp/>for<sp/>LOCAL_SDK_VERSION<sp/>in<sp/>output</highlight></codeline>
<codeline lineno="136"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="137"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespacegyp_1_1common_1a62411b7ed9f7220bb951ea26e91e4e15" kindref="member">gyp.common.EnsureDirExists</ref>(output_filename)</highlight></codeline>
<codeline lineno="138"><highlight class="normal"></highlight></codeline>
<codeline lineno="139" refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1a797b61134908691a06ff70c9899e9a6e" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1a797b61134908691a06ff70c9899e9a6e" kindref="member">fp</ref><sp/>=<sp/>open(output_filename,<sp/></highlight><highlight class="stringliteral">&quot;w&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="140"><highlight class="normal"></highlight></codeline>
<codeline lineno="141"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1a797b61134908691a06ff70c9899e9a6e" kindref="member">fp</ref>.write(header)</highlight></codeline>
<codeline lineno="142"><highlight class="normal"></highlight></codeline>
<codeline lineno="143" refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1a3ef804cd75882ac9e61219863fad76e2" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1a3ef804cd75882ac9e61219863fad76e2" kindref="member">qualified_target</ref><sp/>=<sp/>qualified_target</highlight></codeline>
<codeline lineno="144" refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1a433fbe25872fab1a7ef1f7c9824d189e" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1a433fbe25872fab1a7ef1f7c9824d189e" kindref="member">relative_target</ref><sp/>=<sp/>relative_target</highlight></codeline>
<codeline lineno="145" refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1aa40cc309d9d8adc770d83510757dc0cb" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1aa40cc309d9d8adc770d83510757dc0cb" kindref="member">path</ref><sp/>=<sp/>base_path</highlight></codeline>
<codeline lineno="146" refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1a5e68bf68b8950fe2ac3038c730477682" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1a5e68bf68b8950fe2ac3038c730477682" kindref="member">target</ref><sp/>=<sp/>spec[</highlight><highlight class="stringliteral">&quot;target_name&quot;</highlight><highlight class="normal">]</highlight></codeline>
<codeline lineno="147" refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1a6d061a84eb6f6ab0d1dfeabd0ea61f04" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1a6d061a84eb6f6ab0d1dfeabd0ea61f04" kindref="member">type</ref><sp/>=<sp/>spec[</highlight><highlight class="stringliteral">&quot;type&quot;</highlight><highlight class="normal">]</highlight></codeline>
<codeline lineno="148" refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1aac067c5ee71afa848000a1f5e0138be1" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1aac067c5ee71afa848000a1f5e0138be1" kindref="member">toolset</ref><sp/>=<sp/>spec[</highlight><highlight class="stringliteral">&quot;toolset&quot;</highlight><highlight class="normal">]</highlight></codeline>
<codeline lineno="149"><highlight class="normal"></highlight></codeline>
<codeline lineno="150"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>deps,<sp/>link_deps<sp/>=<sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1a31e97f3ac28bc9e69e8b0cc194702673" kindref="member">ComputeDeps</ref>(spec)</highlight></codeline>
<codeline lineno="151"><highlight class="normal"></highlight></codeline>
<codeline lineno="152"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>Some<sp/>of<sp/>the<sp/>generation<sp/>below<sp/>can<sp/>add<sp/>extra<sp/>output,<sp/>sources,<sp/>or</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="153"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>link<sp/>dependencies.<sp/><sp/>All<sp/>of<sp/>the<sp/>out<sp/>params<sp/>of<sp/>the<sp/>functions<sp/>that</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="154"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>follow<sp/>use<sp/>names<sp/>like<sp/>extra_foo.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="155"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>extra_outputs<sp/>=<sp/>[]</highlight></codeline>
<codeline lineno="156"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>extra_sources<sp/>=<sp/>[]</highlight></codeline>
<codeline lineno="157"><highlight class="normal"></highlight></codeline>
<codeline lineno="158" refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1a56c63ff5c3056b84cee4565e01b7b74f" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1a56c63ff5c3056b84cee4565e01b7b74f" kindref="member">android_class</ref><sp/>=<sp/>MODULE_CLASSES.get(self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1a6d061a84eb6f6ab0d1dfeabd0ea61f04" kindref="member">type</ref>,<sp/></highlight><highlight class="stringliteral">&quot;GYP&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="159" refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1abfa6ab16aba8a08680d3397d4f55761f" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1abfa6ab16aba8a08680d3397d4f55761f" kindref="member">android_module</ref><sp/>=<sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1ac7fa7e6545954db5532c4dd8eaeed452" kindref="member">ComputeAndroidModule</ref>(spec)</highlight></codeline>
<codeline lineno="160" refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1ac37a91617947fa4b0f011dcd98a0e192" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1ac37a91617947fa4b0f011dcd98a0e192" kindref="member">android_stem</ref>,<sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1a9a7672ba98962c100cf3135925aed889" kindref="member">android_suffix</ref>)<sp/>=<sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1ab734f66c93811de4be017ffbfbb05b73" kindref="member">ComputeOutputParts</ref>(spec)</highlight></codeline>
<codeline lineno="161" refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1a432b8283c80e414eaeb0cb63107effe3" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1a432b8283c80e414eaeb0cb63107effe3" kindref="member">output</ref><sp/>=<sp/>self.output_binary<sp/>=<sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1a79cc3f0ff504e5ae8b77c49ac871d47a" kindref="member">ComputeOutput</ref>(spec)</highlight></codeline>
<codeline lineno="162"><highlight class="normal"></highlight></codeline>
<codeline lineno="163"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>Standard<sp/>header.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="164"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1ac4046b7ff870a361f075cda0e1f872d1" kindref="member">WriteLn</ref>(</highlight><highlight class="stringliteral">&quot;include<sp/>$(CLEAR_VARS)\n&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="165"><highlight class="normal"></highlight></codeline>
<codeline lineno="166"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>Module<sp/>class<sp/>and<sp/>name.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="167"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1ac4046b7ff870a361f075cda0e1f872d1" kindref="member">WriteLn</ref>(</highlight><highlight class="stringliteral">&quot;LOCAL_MODULE_CLASS<sp/>:=<sp/>&quot;</highlight><highlight class="normal"><sp/>+<sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1a56c63ff5c3056b84cee4565e01b7b74f" kindref="member">android_class</ref>)</highlight></codeline>
<codeline lineno="168"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1ac4046b7ff870a361f075cda0e1f872d1" kindref="member">WriteLn</ref>(</highlight><highlight class="stringliteral">&quot;LOCAL_MODULE<sp/>:=<sp/>&quot;</highlight><highlight class="normal"><sp/>+<sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1abfa6ab16aba8a08680d3397d4f55761f" kindref="member">android_module</ref>)</highlight></codeline>
<codeline lineno="169"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>Only<sp/>emit<sp/>LOCAL_MODULE_STEM<sp/>if<sp/>it&apos;s<sp/>different<sp/>to<sp/>LOCAL_MODULE.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="170"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>The<sp/>library<sp/>module<sp/>classes<sp/>fail<sp/>if<sp/>the<sp/>stem<sp/>is<sp/>set.<sp/>ComputeOutputParts</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="171"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>makes<sp/>sure<sp/>that<sp/>stem<sp/>==<sp/>modulename<sp/>in<sp/>these<sp/>cases.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="172"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1ac37a91617947fa4b0f011dcd98a0e192" kindref="member">android_stem</ref><sp/>!=<sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1abfa6ab16aba8a08680d3397d4f55761f" kindref="member">android_module</ref>:</highlight></codeline>
<codeline lineno="173"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1ac4046b7ff870a361f075cda0e1f872d1" kindref="member">WriteLn</ref>(</highlight><highlight class="stringliteral">&quot;LOCAL_MODULE_STEM<sp/>:=<sp/>&quot;</highlight><highlight class="normal"><sp/>+<sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1ac37a91617947fa4b0f011dcd98a0e192" kindref="member">android_stem</ref>)</highlight></codeline>
<codeline lineno="174"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1ac4046b7ff870a361f075cda0e1f872d1" kindref="member">WriteLn</ref>(</highlight><highlight class="stringliteral">&quot;LOCAL_MODULE_SUFFIX<sp/>:=<sp/>&quot;</highlight><highlight class="normal"><sp/>+<sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1a9a7672ba98962c100cf3135925aed889" kindref="member">android_suffix</ref>)</highlight></codeline>
<codeline lineno="175"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1aac067c5ee71afa848000a1f5e0138be1" kindref="member">toolset</ref><sp/>==<sp/></highlight><highlight class="stringliteral">&quot;host&quot;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="176"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1ac4046b7ff870a361f075cda0e1f872d1" kindref="member">WriteLn</ref>(</highlight><highlight class="stringliteral">&quot;LOCAL_IS_HOST_MODULE<sp/>:=<sp/>true&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="177"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1ac4046b7ff870a361f075cda0e1f872d1" kindref="member">WriteLn</ref>(</highlight><highlight class="stringliteral">&quot;LOCAL_MULTILIB<sp/>:=<sp/>$(GYP_HOST_MULTILIB)&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="178"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>sdk_version<sp/>&gt;<sp/>0:</highlight></codeline>
<codeline lineno="179"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1ac4046b7ff870a361f075cda0e1f872d1" kindref="member">WriteLn</ref>(</highlight></codeline>
<codeline lineno="180"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;LOCAL_MODULE_TARGET_ARCH<sp/>:=<sp/>&quot;</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&quot;$(TARGET_$(GYP_VAR_PREFIX)ARCH)&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="181"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>)</highlight></codeline>
<codeline lineno="182"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1ac4046b7ff870a361f075cda0e1f872d1" kindref="member">WriteLn</ref>(</highlight><highlight class="stringliteral">&quot;LOCAL_SDK_VERSION<sp/>:=<sp/>%s&quot;</highlight><highlight class="normal"><sp/>%<sp/>sdk_version)</highlight></codeline>
<codeline lineno="183"><highlight class="normal"></highlight></codeline>
<codeline lineno="184"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>Grab<sp/>output<sp/>directories;<sp/>needed<sp/>for<sp/>Actions<sp/>and<sp/>Rules.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="185"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1aac067c5ee71afa848000a1f5e0138be1" kindref="member">toolset</ref><sp/>==<sp/></highlight><highlight class="stringliteral">&quot;host&quot;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="186"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1ac4046b7ff870a361f075cda0e1f872d1" kindref="member">WriteLn</ref>(</highlight></codeline>
<codeline lineno="187"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;gyp_intermediate_dir<sp/>:=<sp/>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="188"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;$(call<sp/>local-intermediates-dir,,$(GYP_HOST_VAR_PREFIX))&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="189"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>)</highlight></codeline>
<codeline lineno="190"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="191"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1ac4046b7ff870a361f075cda0e1f872d1" kindref="member">WriteLn</ref>(</highlight></codeline>
<codeline lineno="192"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;gyp_intermediate_dir<sp/>:=<sp/>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="193"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;$(call<sp/>local-intermediates-dir,,$(GYP_VAR_PREFIX))&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="194"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>)</highlight></codeline>
<codeline lineno="195"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1ac4046b7ff870a361f075cda0e1f872d1" kindref="member">WriteLn</ref>(</highlight></codeline>
<codeline lineno="196"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;gyp_shared_intermediate_dir<sp/>:=<sp/>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="197"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;$(call<sp/>intermediates-dir-for,GYP,shared,,,$(GYP_VAR_PREFIX))&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="198"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>)</highlight></codeline>
<codeline lineno="199"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1ac4046b7ff870a361f075cda0e1f872d1" kindref="member">WriteLn</ref>()</highlight></codeline>
<codeline lineno="200"><highlight class="normal"></highlight></codeline>
<codeline lineno="201"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>List<sp/>files<sp/>this<sp/>target<sp/>depends<sp/>on<sp/>so<sp/>that<sp/>actions/rules/copies/sources</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="202"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>can<sp/>depend<sp/>on<sp/>the<sp/>list.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="203"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>TODO:<sp/>doesn&apos;t<sp/>pull<sp/>in<sp/>things<sp/>through<sp/>transitive<sp/>link<sp/>deps;<sp/>needed?</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="204"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>target_dependencies<sp/>=<sp/>[x[1]<sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>x<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>deps<sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>x[0]<sp/>==<sp/></highlight><highlight class="stringliteral">&quot;path&quot;</highlight><highlight class="normal">]</highlight></codeline>
<codeline lineno="205"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1ac4046b7ff870a361f075cda0e1f872d1" kindref="member">WriteLn</ref>(</highlight><highlight class="stringliteral">&quot;#<sp/>Make<sp/>sure<sp/>our<sp/>deps<sp/>are<sp/>built<sp/>first.&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="206"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1a043072c186835f10859fccfc7409e708" kindref="member">WriteList</ref>(</highlight></codeline>
<codeline lineno="207"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>target_dependencies,<sp/></highlight><highlight class="stringliteral">&quot;GYP_TARGET_DEPENDENCIES&quot;</highlight><highlight class="normal">,<sp/>local_pathify=</highlight><highlight class="keyword">True</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="208"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>)</highlight></codeline>
<codeline lineno="209"><highlight class="normal"></highlight></codeline>
<codeline lineno="210"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>Actions<sp/>must<sp/>come<sp/>first,<sp/>since<sp/>they<sp/>can<sp/>generate<sp/>more<sp/>OBJs<sp/>for<sp/>use<sp/>below.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="211"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&quot;actions&quot;</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>spec:</highlight></codeline>
<codeline lineno="212"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1a997c6f57693e9d1254987c885fe4a06a" kindref="member">WriteActions</ref>(spec[</highlight><highlight class="stringliteral">&quot;actions&quot;</highlight><highlight class="normal">],<sp/>extra_sources,<sp/>extra_outputs)</highlight></codeline>
<codeline lineno="213"><highlight class="normal"></highlight></codeline>
<codeline lineno="214"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>Rules<sp/>must<sp/>be<sp/>early<sp/>like<sp/>actions.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="215"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&quot;rules&quot;</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>spec:</highlight></codeline>
<codeline lineno="216"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1a80a387a437f2c8a5deed813e2ddc924d" kindref="member">WriteRules</ref>(spec[</highlight><highlight class="stringliteral">&quot;rules&quot;</highlight><highlight class="normal">],<sp/>extra_sources,<sp/>extra_outputs)</highlight></codeline>
<codeline lineno="217"><highlight class="normal"></highlight></codeline>
<codeline lineno="218"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&quot;copies&quot;</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>spec:</highlight></codeline>
<codeline lineno="219"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1a620445f975ae8b4f85b42c73fdb18d91" kindref="member">WriteCopies</ref>(spec[</highlight><highlight class="stringliteral">&quot;copies&quot;</highlight><highlight class="normal">],<sp/>extra_outputs)</highlight></codeline>
<codeline lineno="220"><highlight class="normal"></highlight></codeline>
<codeline lineno="221"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>GYP<sp/>generated<sp/>outputs.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="222"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1a043072c186835f10859fccfc7409e708" kindref="member">WriteList</ref>(extra_outputs,<sp/></highlight><highlight class="stringliteral">&quot;GYP_GENERATED_OUTPUTS&quot;</highlight><highlight class="normal">,<sp/>local_pathify=</highlight><highlight class="keyword">True</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="223"><highlight class="normal"></highlight></codeline>
<codeline lineno="224"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>Set<sp/>LOCAL_ADDITIONAL_DEPENDENCIES<sp/>so<sp/>that<sp/>Android&apos;s<sp/>build<sp/>rules<sp/>depend</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="225"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>on<sp/>both<sp/>our<sp/>dependency<sp/>targets<sp/>and<sp/>our<sp/>generated<sp/>files.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="226"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1ac4046b7ff870a361f075cda0e1f872d1" kindref="member">WriteLn</ref>(</highlight><highlight class="stringliteral">&quot;#<sp/>Make<sp/>sure<sp/>our<sp/>deps<sp/>and<sp/>generated<sp/>files<sp/>are<sp/>built<sp/>first.&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="227"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1ac4046b7ff870a361f075cda0e1f872d1" kindref="member">WriteLn</ref>(</highlight></codeline>
<codeline lineno="228"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;LOCAL_ADDITIONAL_DEPENDENCIES<sp/>:=<sp/>$(GYP_TARGET_DEPENDENCIES)<sp/>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="229"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;$(GYP_GENERATED_OUTPUTS)&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="230"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>)</highlight></codeline>
<codeline lineno="231"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1ac4046b7ff870a361f075cda0e1f872d1" kindref="member">WriteLn</ref>()</highlight></codeline>
<codeline lineno="232"><highlight class="normal"></highlight></codeline>
<codeline lineno="233"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>Sources.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="234"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>spec.get(</highlight><highlight class="stringliteral">&quot;sources&quot;</highlight><highlight class="normal">,<sp/>[])<sp/></highlight><highlight class="keywordflow">or</highlight><highlight class="normal"><sp/>extra_sources:</highlight></codeline>
<codeline lineno="235"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1aa5b0a2d998b448f503c8f46f034d50c5" kindref="member">WriteSources</ref>(spec,<sp/>configs,<sp/>extra_sources)</highlight></codeline>
<codeline lineno="236"><highlight class="normal"></highlight></codeline>
<codeline lineno="237"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1a0203644abb72a4a0db1c51a3ed6a4892" kindref="member">WriteTarget</ref>(</highlight></codeline>
<codeline lineno="238"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>spec,<sp/>configs,<sp/>deps,<sp/>link_deps,<sp/>part_of_all,<sp/>write_alias_target</highlight></codeline>
<codeline lineno="239"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>)</highlight></codeline>
<codeline lineno="240"><highlight class="normal"></highlight></codeline>
<codeline lineno="241"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>Update<sp/>global<sp/>list<sp/>of<sp/>target<sp/>outputs,<sp/>used<sp/>in<sp/>dependency<sp/>tracking.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="242"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>target_outputs[qualified_target]<sp/>=<sp/>(</highlight><highlight class="stringliteral">&quot;path&quot;</highlight><highlight class="normal">,<sp/>self.output_binary)</highlight></codeline>
<codeline lineno="243"><highlight class="normal"></highlight></codeline>
<codeline lineno="244"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>Update<sp/>global<sp/>list<sp/>of<sp/>link<sp/>dependencies.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="245"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1a6d061a84eb6f6ab0d1dfeabd0ea61f04" kindref="member">type</ref><sp/>==<sp/></highlight><highlight class="stringliteral">&quot;static_library&quot;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="246"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>target_link_deps[qualified_target]<sp/>=<sp/>(</highlight><highlight class="stringliteral">&quot;static&quot;</highlight><highlight class="normal">,<sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1abfa6ab16aba8a08680d3397d4f55761f" kindref="member">android_module</ref>)</highlight></codeline>
<codeline lineno="247"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1a6d061a84eb6f6ab0d1dfeabd0ea61f04" kindref="member">type</ref><sp/>==<sp/></highlight><highlight class="stringliteral">&quot;shared_library&quot;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="248"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>target_link_deps[qualified_target]<sp/>=<sp/>(</highlight><highlight class="stringliteral">&quot;shared&quot;</highlight><highlight class="normal">,<sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1abfa6ab16aba8a08680d3397d4f55761f" kindref="member">android_module</ref>)</highlight></codeline>
<codeline lineno="249"><highlight class="normal"></highlight></codeline>
<codeline lineno="250"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1a797b61134908691a06ff70c9899e9a6e" kindref="member">fp</ref>.close()</highlight></codeline>
<codeline lineno="251"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1abfa6ab16aba8a08680d3397d4f55761f" kindref="member">android_module</ref></highlight></codeline>
<codeline lineno="252"><highlight class="normal"></highlight></codeline>
<codeline lineno="253" refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1a997c6f57693e9d1254987c885fe4a06a" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1a997c6f57693e9d1254987c885fe4a06a" kindref="member">WriteActions</ref>(self,<sp/>actions,<sp/>extra_sources,<sp/>extra_outputs):</highlight></codeline>
<codeline lineno="254"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Write<sp/>Makefile<sp/>code<sp/>for<sp/>any<sp/>&apos;actions&apos;<sp/>from<sp/>the<sp/>gyp<sp/>input.</highlight></codeline>
<codeline lineno="255"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="256"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>extra_sources:<sp/>a<sp/>list<sp/>that<sp/>will<sp/>be<sp/>filled<sp/>in<sp/>with<sp/>newly<sp/>generated<sp/>source</highlight></codeline>
<codeline lineno="257"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>files,<sp/>if<sp/>any</highlight></codeline>
<codeline lineno="258"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>extra_outputs:<sp/>a<sp/>list<sp/>that<sp/>will<sp/>be<sp/>filled<sp/>in<sp/>with<sp/>any<sp/>outputs<sp/>of<sp/>these</highlight></codeline>
<codeline lineno="259"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>actions<sp/>(used<sp/>to<sp/>make<sp/>other<sp/>pieces<sp/>dependent<sp/>on<sp/>these</highlight></codeline>
<codeline lineno="260"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>actions)</highlight></codeline>
<codeline lineno="261"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="262"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>action<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>actions:</highlight></codeline>
<codeline lineno="263"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>name<sp/>=<sp/>make.StringToMakefileVariable(</highlight></codeline>
<codeline lineno="264"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;{}_{}&quot;</highlight><highlight class="normal">.format(self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1a433fbe25872fab1a7ef1f7c9824d189e" kindref="member">relative_target</ref>,<sp/>action[</highlight><highlight class="stringliteral">&quot;action_name&quot;</highlight><highlight class="normal">])</highlight></codeline>
<codeline lineno="265"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>)</highlight></codeline>
<codeline lineno="266"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1ac4046b7ff870a361f075cda0e1f872d1" kindref="member">WriteLn</ref>(</highlight><highlight class="stringliteral">&apos;###<sp/>Rules<sp/>for<sp/>action<sp/>&quot;%s&quot;:&apos;</highlight><highlight class="normal"><sp/>%<sp/>action[</highlight><highlight class="stringliteral">&quot;action_name&quot;</highlight><highlight class="normal">])</highlight></codeline>
<codeline lineno="267"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>inputs<sp/>=<sp/>action[</highlight><highlight class="stringliteral">&quot;inputs&quot;</highlight><highlight class="normal">]</highlight></codeline>
<codeline lineno="268"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>outputs<sp/>=<sp/>action[</highlight><highlight class="stringliteral">&quot;outputs&quot;</highlight><highlight class="normal">]</highlight></codeline>
<codeline lineno="269"><highlight class="normal"></highlight></codeline>
<codeline lineno="270"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>Build<sp/>up<sp/>a<sp/>list<sp/>of<sp/>outputs.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="271"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>Collect<sp/>the<sp/>output<sp/>dirs<sp/>we&apos;ll<sp/>need.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="272"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dirs<sp/>=<sp/>set()</highlight></codeline>
<codeline lineno="273"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>out<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>outputs:</highlight></codeline>
<codeline lineno="274"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>out.startswith(</highlight><highlight class="stringliteral">&quot;$&quot;</highlight><highlight class="normal">):</highlight></codeline>
<codeline lineno="275"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>print(</highlight></codeline>
<codeline lineno="276"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;WARNING:<sp/>Action<sp/>for<sp/>target<sp/>&quot;%s&quot;<sp/>writes<sp/>output<sp/>to<sp/>local<sp/>path<sp/>&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="277"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;&quot;%s&quot;.&apos;</highlight><highlight class="normal"><sp/>%<sp/>(self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1a5e68bf68b8950fe2ac3038c730477682" kindref="member">target</ref>,<sp/>out)</highlight></codeline>
<codeline lineno="278"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>)</highlight></codeline>
<codeline lineno="279"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dir<sp/>=<sp/>os.path.split(out)[0]</highlight></codeline>
<codeline lineno="280"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>dir:</highlight></codeline>
<codeline lineno="281"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dirs.add(dir)</highlight></codeline>
<codeline lineno="282"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>int(action.get(</highlight><highlight class="stringliteral">&quot;process_outputs_as_sources&quot;</highlight><highlight class="normal">,<sp/></highlight><highlight class="keyword">False</highlight><highlight class="normal">)):</highlight></codeline>
<codeline lineno="283"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>extra_sources<sp/>+=<sp/>outputs</highlight></codeline>
<codeline lineno="284"><highlight class="normal"></highlight></codeline>
<codeline lineno="285"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>Prepare<sp/>the<sp/>actual<sp/>command.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="286"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>command<sp/>=<sp/><ref refid="namespacegyp_1_1common_1a1681405bb09a2eda416079b3ed7de917" kindref="member">gyp.common.EncodePOSIXShellList</ref>(action[</highlight><highlight class="stringliteral">&quot;action&quot;</highlight><highlight class="normal">])</highlight></codeline>
<codeline lineno="287"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&quot;message&quot;</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>action:</highlight></codeline>
<codeline lineno="288"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>quiet_cmd<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;Gyp<sp/>action:<sp/>%s<sp/>($@)&quot;</highlight><highlight class="normal"><sp/>%<sp/>action[</highlight><highlight class="stringliteral">&quot;message&quot;</highlight><highlight class="normal">]</highlight></codeline>
<codeline lineno="289"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="290"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>quiet_cmd<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;Gyp<sp/>action:<sp/>%s<sp/>($@)&quot;</highlight><highlight class="normal"><sp/>%<sp/>name</highlight></codeline>
<codeline lineno="291"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>len(dirs)<sp/>&gt;<sp/>0:</highlight></codeline>
<codeline lineno="292"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>command<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;mkdir<sp/>-p<sp/>%s&quot;</highlight><highlight class="normal"><sp/>%<sp/></highlight><highlight class="stringliteral">&quot;<sp/>&quot;</highlight><highlight class="normal">.join(dirs)<sp/>+<sp/></highlight><highlight class="stringliteral">&quot;;<sp/>&quot;</highlight><highlight class="normal"><sp/>+<sp/>command</highlight></codeline>
<codeline lineno="293"><highlight class="normal"></highlight></codeline>
<codeline lineno="294"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cd_action<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;cd<sp/>$(gyp_local_path)/%s;<sp/>&quot;</highlight><highlight class="normal"><sp/>%<sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1aa40cc309d9d8adc770d83510757dc0cb" kindref="member">path</ref></highlight></codeline>
<codeline lineno="295"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>command<sp/>=<sp/>cd_action<sp/>+<sp/>command</highlight></codeline>
<codeline lineno="296"><highlight class="normal"></highlight></codeline>
<codeline lineno="297"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>The<sp/>makefile<sp/>rules<sp/>are<sp/>all<sp/>relative<sp/>to<sp/>the<sp/>top<sp/>dir,<sp/>but<sp/>the<sp/>gyp<sp/>actions</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="298"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>are<sp/>defined<sp/>relative<sp/>to<sp/>their<sp/>containing<sp/>dir.<sp/><sp/>This<sp/>replaces<sp/>the<sp/>gyp_*</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="299"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>variables<sp/>for<sp/>the<sp/>action<sp/>rule<sp/>with<sp/>an<sp/>absolute<sp/>version<sp/>so<sp/>that<sp/>the</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="300"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>output<sp/>goes<sp/>in<sp/>the<sp/>right<sp/>place.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="301"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>Only<sp/>write<sp/>the<sp/>gyp_*<sp/>rules<sp/>for<sp/>the<sp/>&quot;primary&quot;<sp/>output<sp/>(:1);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="302"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>it&apos;s<sp/>superfluous<sp/>for<sp/>the<sp/>&quot;extra<sp/>outputs&quot;,<sp/>and<sp/>this<sp/>avoids<sp/>accidentally</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="303"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>writing<sp/>duplicate<sp/>dummy<sp/>rules<sp/>for<sp/>those<sp/>outputs.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="304"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>main_output<sp/>=<sp/>make.QuoteSpaces(self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1a172c16217eab4fca1017c7d4fabcbf1d" kindref="member">LocalPathify</ref><ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1aadd56929484e5da3d614414dbb9bcd30" kindref="member">LocalPathify</ref>(outputs[0]))</highlight></codeline>
<codeline lineno="305"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1ac4046b7ff870a361f075cda0e1f872d1" kindref="member">WriteLn</ref>(</highlight><highlight class="stringliteral">&quot;%s:<sp/>gyp_local_path<sp/>:=<sp/>$(LOCAL_PATH)&quot;</highlight><highlight class="normal"><sp/>%<sp/>main_output)</highlight></codeline>
<codeline lineno="306"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1ac4046b7ff870a361f075cda0e1f872d1" kindref="member">WriteLn</ref>(</highlight><highlight class="stringliteral">&quot;%s:<sp/>gyp_var_prefix<sp/>:=<sp/>$(GYP_VAR_PREFIX)&quot;</highlight><highlight class="normal"><sp/>%<sp/>main_output)</highlight></codeline>
<codeline lineno="307"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1ac4046b7ff870a361f075cda0e1f872d1" kindref="member">WriteLn</ref>(</highlight></codeline>
<codeline lineno="308"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;%s:<sp/>gyp_intermediate_dir<sp/>:=<sp/>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="309"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;$(abspath<sp/>$(gyp_intermediate_dir))&quot;</highlight><highlight class="normal"><sp/>%<sp/>main_output</highlight></codeline>
<codeline lineno="310"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>)</highlight></codeline>
<codeline lineno="311"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1ac4046b7ff870a361f075cda0e1f872d1" kindref="member">WriteLn</ref>(</highlight></codeline>
<codeline lineno="312"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;%s:<sp/>gyp_shared_intermediate_dir<sp/>:=<sp/>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="313"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;$(abspath<sp/>$(gyp_shared_intermediate_dir))&quot;</highlight><highlight class="normal"><sp/>%<sp/>main_output</highlight></codeline>
<codeline lineno="314"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>)</highlight></codeline>
<codeline lineno="315"><highlight class="normal"></highlight></codeline>
<codeline lineno="316"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>Android&apos;s<sp/>envsetup.sh<sp/>adds<sp/>a<sp/>number<sp/>of<sp/>directories<sp/>to<sp/>the<sp/>path<sp/>including</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="317"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>the<sp/>built<sp/>host<sp/>binary<sp/>directory.<sp/>This<sp/>causes<sp/>actions/rules<sp/>invoked<sp/>by</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="318"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>gyp<sp/>to<sp/>sometimes<sp/>use<sp/>these<sp/>instead<sp/>of<sp/>system<sp/>versions,<sp/>e.g.<sp/>bison.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="319"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>The<sp/>built<sp/>host<sp/>binaries<sp/>may<sp/>not<sp/>be<sp/>suitable,<sp/>and<sp/>can<sp/>cause<sp/>errors.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="320"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>So,<sp/>we<sp/>remove<sp/>them<sp/>from<sp/>the<sp/>PATH<sp/>using<sp/>the<sp/>ANDROID_BUILD_PATHS<sp/>variable</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="321"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>set<sp/>by<sp/>envsetup.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="322"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1ac4046b7ff870a361f075cda0e1f872d1" kindref="member">WriteLn</ref>(</highlight></codeline>
<codeline lineno="323"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;%s:<sp/>export<sp/>PATH<sp/>:=<sp/>$(subst<sp/>$(ANDROID_BUILD_PATHS),,$(PATH))&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="324"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>%<sp/>main_output</highlight></codeline>
<codeline lineno="325"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>)</highlight></codeline>
<codeline lineno="326"><highlight class="normal"></highlight></codeline>
<codeline lineno="327"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>Don&apos;t<sp/>allow<sp/>spaces<sp/>in<sp/>input/output<sp/>filenames,<sp/>but<sp/>make<sp/>an<sp/>exception<sp/>for</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="328"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>filenames<sp/>which<sp/>start<sp/>with<sp/>&apos;$(&apos;<sp/>since<sp/>it&apos;s<sp/>okay<sp/>for<sp/>there<sp/>to<sp/>be<sp/>spaces</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="329"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>inside<sp/>of<sp/>make<sp/>function/macro<sp/>invocations.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="330"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>input<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>inputs:</highlight></codeline>
<codeline lineno="331"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>input.startswith(</highlight><highlight class="stringliteral">&quot;$(&quot;</highlight><highlight class="normal">)<sp/></highlight><highlight class="keywordflow">and</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&quot;<sp/>&quot;</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>input:</highlight></codeline>
<codeline lineno="332"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">raise</highlight><highlight class="normal"><sp/><ref refid="classgyp_1_1common_1_1_gyp_error" kindref="compound">gyp.common.GypError</ref>(</highlight></codeline>
<codeline lineno="333"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;Action<sp/>input<sp/>filename<sp/>&quot;%s&quot;<sp/>in<sp/>target<sp/>%s<sp/>contains<sp/>a<sp/>space&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="334"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>%<sp/>(input,<sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1a5e68bf68b8950fe2ac3038c730477682" kindref="member">target</ref>)</highlight></codeline>
<codeline lineno="335"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>)</highlight></codeline>
<codeline lineno="336"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>output<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>outputs:</highlight></codeline>
<codeline lineno="337"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>output.startswith(</highlight><highlight class="stringliteral">&quot;$(&quot;</highlight><highlight class="normal">)<sp/></highlight><highlight class="keywordflow">and</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&quot;<sp/>&quot;</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>output:</highlight></codeline>
<codeline lineno="338"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">raise</highlight><highlight class="normal"><sp/><ref refid="classgyp_1_1common_1_1_gyp_error" kindref="compound">gyp.common.GypError</ref>(</highlight></codeline>
<codeline lineno="339"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;Action<sp/>output<sp/>filename<sp/>&quot;%s&quot;<sp/>in<sp/>target<sp/>%s<sp/>contains<sp/>a<sp/>space&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="340"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>%<sp/>(output,<sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1a5e68bf68b8950fe2ac3038c730477682" kindref="member">target</ref>)</highlight></codeline>
<codeline lineno="341"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>)</highlight></codeline>
<codeline lineno="342"><highlight class="normal"></highlight></codeline>
<codeline lineno="343"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1ac4046b7ff870a361f075cda0e1f872d1" kindref="member">WriteLn</ref>(</highlight></codeline>
<codeline lineno="344"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;%s:<sp/>%s<sp/>$(GYP_TARGET_DEPENDENCIES)&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="345" refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1a172c16217eab4fca1017c7d4fabcbf1d" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>%<sp/>(main_output,<sp/></highlight><highlight class="stringliteral">&quot;<sp/>&quot;</highlight><highlight class="normal">.join(map(self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1a172c16217eab4fca1017c7d4fabcbf1d" kindref="member">LocalPathify</ref><ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1aadd56929484e5da3d614414dbb9bcd30" kindref="member">LocalPathify</ref>,<sp/>inputs)))</highlight></codeline>
<codeline lineno="346"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>)</highlight></codeline>
<codeline lineno="347"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1ac4046b7ff870a361f075cda0e1f872d1" kindref="member">WriteLn</ref>(</highlight><highlight class="stringliteral">&apos;\t@echo<sp/>&quot;%s&quot;&apos;</highlight><highlight class="normal"><sp/>%<sp/>quiet_cmd)</highlight></codeline>
<codeline lineno="348"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1ac4046b7ff870a361f075cda0e1f872d1" kindref="member">WriteLn</ref>(</highlight><highlight class="stringliteral">&quot;\t$(hide)%s\n&quot;</highlight><highlight class="normal"><sp/>%<sp/>command)</highlight></codeline>
<codeline lineno="349"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>output<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>outputs[1:]:</highlight></codeline>
<codeline lineno="350"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>Make<sp/>each<sp/>output<sp/>depend<sp/>on<sp/>the<sp/>main<sp/>output,<sp/>with<sp/>an<sp/>empty<sp/>command</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="351"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>to<sp/>force<sp/>make<sp/>to<sp/>notice<sp/>that<sp/>the<sp/>mtime<sp/>has<sp/>changed.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="352"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1ac4046b7ff870a361f075cda0e1f872d1" kindref="member">WriteLn</ref>(f</highlight><highlight class="stringliteral">&quot;{self.LocalPathify(output)}:<sp/>{main_output}<sp/>;&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="353"><highlight class="normal"></highlight></codeline>
<codeline lineno="354"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>extra_outputs<sp/>+=<sp/>outputs</highlight></codeline>
<codeline lineno="355"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1ac4046b7ff870a361f075cda0e1f872d1" kindref="member">WriteLn</ref>()</highlight></codeline>
<codeline lineno="356"><highlight class="normal"></highlight></codeline>
<codeline lineno="357"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1ac4046b7ff870a361f075cda0e1f872d1" kindref="member">WriteLn</ref>()</highlight></codeline>
<codeline lineno="358"><highlight class="normal"></highlight></codeline>
<codeline lineno="359" refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1a80a387a437f2c8a5deed813e2ddc924d" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1a80a387a437f2c8a5deed813e2ddc924d" kindref="member">WriteRules</ref>(self,<sp/>rules,<sp/>extra_sources,<sp/>extra_outputs):</highlight></codeline>
<codeline lineno="360"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Write<sp/>Makefile<sp/>code<sp/>for<sp/>any<sp/>&apos;rules&apos;<sp/>from<sp/>the<sp/>gyp<sp/>input.</highlight></codeline>
<codeline lineno="361"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="362"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>extra_sources:<sp/>a<sp/>list<sp/>that<sp/>will<sp/>be<sp/>filled<sp/>in<sp/>with<sp/>newly<sp/>generated<sp/>source</highlight></codeline>
<codeline lineno="363"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>files,<sp/>if<sp/>any</highlight></codeline>
<codeline lineno="364"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>extra_outputs:<sp/>a<sp/>list<sp/>that<sp/>will<sp/>be<sp/>filled<sp/>in<sp/>with<sp/>any<sp/>outputs<sp/>of<sp/>these</highlight></codeline>
<codeline lineno="365"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rules<sp/>(used<sp/>to<sp/>make<sp/>other<sp/>pieces<sp/>dependent<sp/>on<sp/>these<sp/>rules)</highlight></codeline>
<codeline lineno="366"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="367"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>len(rules)<sp/>==<sp/>0:</highlight></codeline>
<codeline lineno="368"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="369"><highlight class="normal"></highlight></codeline>
<codeline lineno="370"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>rule<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>rules:</highlight></codeline>
<codeline lineno="371"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>len(rule.get(</highlight><highlight class="stringliteral">&quot;rule_sources&quot;</highlight><highlight class="normal">,<sp/>[]))<sp/>==<sp/>0:</highlight></codeline>
<codeline lineno="372"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="373"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>name<sp/>=<sp/>make.StringToMakefileVariable(</highlight></codeline>
<codeline lineno="374"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;{}_{}&quot;</highlight><highlight class="normal">.format(self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1a433fbe25872fab1a7ef1f7c9824d189e" kindref="member">relative_target</ref>,<sp/>rule[</highlight><highlight class="stringliteral">&quot;rule_name&quot;</highlight><highlight class="normal">])</highlight></codeline>
<codeline lineno="375"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>)</highlight></codeline>
<codeline lineno="376"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1ac4046b7ff870a361f075cda0e1f872d1" kindref="member">WriteLn</ref>(</highlight><highlight class="stringliteral">&apos;\n###<sp/>Generated<sp/>for<sp/>rule<sp/>&quot;%s&quot;:&apos;</highlight><highlight class="normal"><sp/>%<sp/>name)</highlight></codeline>
<codeline lineno="377"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1ac4046b7ff870a361f075cda0e1f872d1" kindref="member">WriteLn</ref>(</highlight><highlight class="stringliteral">&apos;#<sp/>&quot;%s&quot;:&apos;</highlight><highlight class="normal"><sp/>%<sp/>rule)</highlight></codeline>
<codeline lineno="378"><highlight class="normal"></highlight></codeline>
<codeline lineno="379"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>inputs<sp/>=<sp/>rule.get(</highlight><highlight class="stringliteral">&quot;inputs&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="380"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>rule_source<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>rule.get(</highlight><highlight class="stringliteral">&quot;rule_sources&quot;</highlight><highlight class="normal">,<sp/>[]):</highlight></codeline>
<codeline lineno="381"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(rule_source_dirname,<sp/>rule_source_basename)<sp/>=<sp/>os.path.split(rule_source)</highlight></codeline>
<codeline lineno="382"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(rule_source_root,<sp/>rule_source_ext)<sp/>=<sp/>os.path.splitext(</highlight></codeline>
<codeline lineno="383"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rule_source_basename</highlight></codeline>
<codeline lineno="384"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>)</highlight></codeline>
<codeline lineno="385"><highlight class="normal"></highlight></codeline>
<codeline lineno="386"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>outputs<sp/>=<sp/>[</highlight></codeline>
<codeline lineno="387"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1a095f55ed01efb9380c770c0f6f703f4d" kindref="member">ExpandInputRoot</ref>(out,<sp/>rule_source_root,<sp/>rule_source_dirname)</highlight></codeline>
<codeline lineno="388"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>out<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>rule[</highlight><highlight class="stringliteral">&quot;outputs&quot;</highlight><highlight class="normal">]</highlight></codeline>
<codeline lineno="389"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>]</highlight></codeline>
<codeline lineno="390"><highlight class="normal"></highlight></codeline>
<codeline lineno="391"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dirs<sp/>=<sp/>set()</highlight></codeline>
<codeline lineno="392"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>out<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>outputs:</highlight></codeline>
<codeline lineno="393"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>out.startswith(</highlight><highlight class="stringliteral">&quot;$&quot;</highlight><highlight class="normal">):</highlight></codeline>
<codeline lineno="394"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>print(</highlight></codeline>
<codeline lineno="395"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;WARNING:<sp/>Rule<sp/>for<sp/>target<sp/>%s<sp/>writes<sp/>output<sp/>to<sp/>local<sp/>path<sp/>%s&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="396"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>%<sp/>(self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1a5e68bf68b8950fe2ac3038c730477682" kindref="member">target</ref>,<sp/>out)</highlight></codeline>
<codeline lineno="397"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>)</highlight></codeline>
<codeline lineno="398"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dir<sp/>=<sp/>os.path.dirname(out)</highlight></codeline>
<codeline lineno="399"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>dir:</highlight></codeline>
<codeline lineno="400"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dirs.add(dir)</highlight></codeline>
<codeline lineno="401"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>extra_outputs<sp/>+=<sp/>outputs</highlight></codeline>
<codeline lineno="402"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>int(rule.get(</highlight><highlight class="stringliteral">&quot;process_outputs_as_sources&quot;</highlight><highlight class="normal">,<sp/></highlight><highlight class="keyword">False</highlight><highlight class="normal">)):</highlight></codeline>
<codeline lineno="403"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>extra_sources.extend(outputs)</highlight></codeline>
<codeline lineno="404"><highlight class="normal"></highlight></codeline>
<codeline lineno="405"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>components<sp/>=<sp/>[]</highlight></codeline>
<codeline lineno="406"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>component<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>rule[</highlight><highlight class="stringliteral">&quot;action&quot;</highlight><highlight class="normal">]:</highlight></codeline>
<codeline lineno="407"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>component<sp/>=<sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1a095f55ed01efb9380c770c0f6f703f4d" kindref="member">ExpandInputRoot</ref>(</highlight></codeline>
<codeline lineno="408"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>component,<sp/>rule_source_root,<sp/>rule_source_dirname</highlight></codeline>
<codeline lineno="409"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>)</highlight></codeline>
<codeline lineno="410"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&quot;$(RULE_SOURCES)&quot;</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>component:</highlight></codeline>
<codeline lineno="411"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>component<sp/>=<sp/>component.replace(</highlight><highlight class="stringliteral">&quot;$(RULE_SOURCES)&quot;</highlight><highlight class="normal">,<sp/>rule_source)</highlight></codeline>
<codeline lineno="412"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>components.append(component)</highlight></codeline>
<codeline lineno="413"><highlight class="normal"></highlight></codeline>
<codeline lineno="414"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>command<sp/>=<sp/><ref refid="namespacegyp_1_1common_1a1681405bb09a2eda416079b3ed7de917" kindref="member">gyp.common.EncodePOSIXShellList</ref>(components)</highlight></codeline>
<codeline lineno="415"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cd_action<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;cd<sp/>$(gyp_local_path)/%s;<sp/>&quot;</highlight><highlight class="normal"><sp/>%<sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1aa40cc309d9d8adc770d83510757dc0cb" kindref="member">path</ref></highlight></codeline>
<codeline lineno="416"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>command<sp/>=<sp/>cd_action<sp/>+<sp/>command</highlight></codeline>
<codeline lineno="417"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>dirs:</highlight></codeline>
<codeline lineno="418"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>command<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;mkdir<sp/>-p<sp/>%s&quot;</highlight><highlight class="normal"><sp/>%<sp/></highlight><highlight class="stringliteral">&quot;<sp/>&quot;</highlight><highlight class="normal">.join(dirs)<sp/>+<sp/></highlight><highlight class="stringliteral">&quot;;<sp/>&quot;</highlight><highlight class="normal"><sp/>+<sp/>command</highlight></codeline>
<codeline lineno="419"><highlight class="normal"></highlight></codeline>
<codeline lineno="420"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>We<sp/>set<sp/>up<sp/>a<sp/>rule<sp/>to<sp/>build<sp/>the<sp/>first<sp/>output,<sp/>and<sp/>then<sp/>set<sp/>up</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="421"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>a<sp/>rule<sp/>for<sp/>each<sp/>additional<sp/>output<sp/>to<sp/>depend<sp/>on<sp/>the<sp/>first.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="422"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>outputs<sp/>=<sp/>map(self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1a172c16217eab4fca1017c7d4fabcbf1d" kindref="member">LocalPathify</ref><ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1aadd56929484e5da3d614414dbb9bcd30" kindref="member">LocalPathify</ref>,<sp/>outputs)</highlight></codeline>
<codeline lineno="423"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>main_output<sp/>=<sp/>outputs[0]</highlight></codeline>
<codeline lineno="424"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1ac4046b7ff870a361f075cda0e1f872d1" kindref="member">WriteLn</ref>(</highlight><highlight class="stringliteral">&quot;%s:<sp/>gyp_local_path<sp/>:=<sp/>$(LOCAL_PATH)&quot;</highlight><highlight class="normal"><sp/>%<sp/>main_output)</highlight></codeline>
<codeline lineno="425"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1ac4046b7ff870a361f075cda0e1f872d1" kindref="member">WriteLn</ref>(</highlight><highlight class="stringliteral">&quot;%s:<sp/>gyp_var_prefix<sp/>:=<sp/>$(GYP_VAR_PREFIX)&quot;</highlight><highlight class="normal"><sp/>%<sp/>main_output)</highlight></codeline>
<codeline lineno="426"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1ac4046b7ff870a361f075cda0e1f872d1" kindref="member">WriteLn</ref>(</highlight></codeline>
<codeline lineno="427"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;%s:<sp/>gyp_intermediate_dir<sp/>:=<sp/>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="428"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;$(abspath<sp/>$(gyp_intermediate_dir))&quot;</highlight><highlight class="normal"><sp/>%<sp/>main_output</highlight></codeline>
<codeline lineno="429"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>)</highlight></codeline>
<codeline lineno="430"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1ac4046b7ff870a361f075cda0e1f872d1" kindref="member">WriteLn</ref>(</highlight></codeline>
<codeline lineno="431"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;%s:<sp/>gyp_shared_intermediate_dir<sp/>:=<sp/>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="432"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;$(abspath<sp/>$(gyp_shared_intermediate_dir))&quot;</highlight><highlight class="normal"><sp/>%<sp/>main_output</highlight></codeline>
<codeline lineno="433"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>)</highlight></codeline>
<codeline lineno="434"><highlight class="normal"></highlight></codeline>
<codeline lineno="435"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>See<sp/>explanation<sp/>in<sp/>WriteActions.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="436"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1ac4046b7ff870a361f075cda0e1f872d1" kindref="member">WriteLn</ref>(</highlight></codeline>
<codeline lineno="437"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;%s:<sp/>export<sp/>PATH<sp/>:=<sp/>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="438"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;$(subst<sp/>$(ANDROID_BUILD_PATHS),,$(PATH))&quot;</highlight><highlight class="normal"><sp/>%<sp/>main_output</highlight></codeline>
<codeline lineno="439"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>)</highlight></codeline>
<codeline lineno="440"><highlight class="normal"></highlight></codeline>
<codeline lineno="441"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>main_output_deps<sp/>=<sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1a172c16217eab4fca1017c7d4fabcbf1d" kindref="member">LocalPathify</ref><ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1aadd56929484e5da3d614414dbb9bcd30" kindref="member">LocalPathify</ref>(rule_source)</highlight></codeline>
<codeline lineno="442"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>inputs:</highlight></codeline>
<codeline lineno="443"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>main_output_deps<sp/>+=<sp/></highlight><highlight class="stringliteral">&quot;<sp/>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="444"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>main_output_deps<sp/>+=<sp/></highlight><highlight class="stringliteral">&quot;<sp/>&quot;</highlight><highlight class="normal">.join([self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1a172c16217eab4fca1017c7d4fabcbf1d" kindref="member">LocalPathify</ref><ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1aadd56929484e5da3d614414dbb9bcd30" kindref="member">LocalPathify</ref>(f)<sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>f<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>inputs])</highlight></codeline>
<codeline lineno="445"><highlight class="normal"></highlight></codeline>
<codeline lineno="446"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1ac4046b7ff870a361f075cda0e1f872d1" kindref="member">WriteLn</ref>(</highlight></codeline>
<codeline lineno="447"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;%s:<sp/>%s<sp/>$(GYP_TARGET_DEPENDENCIES)&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="448"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>%<sp/>(main_output,<sp/>main_output_deps)</highlight></codeline>
<codeline lineno="449"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>)</highlight></codeline>
<codeline lineno="450"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1ac4046b7ff870a361f075cda0e1f872d1" kindref="member">WriteLn</ref>(</highlight><highlight class="stringliteral">&quot;\t%s\n&quot;</highlight><highlight class="normal"><sp/>%<sp/>command)</highlight></codeline>
<codeline lineno="451"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>output<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>outputs[1:]:</highlight></codeline>
<codeline lineno="452"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>Make<sp/>each<sp/>output<sp/>depend<sp/>on<sp/>the<sp/>main<sp/>output,<sp/>with<sp/>an<sp/>empty<sp/>command</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="453"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>to<sp/>force<sp/>make<sp/>to<sp/>notice<sp/>that<sp/>the<sp/>mtime<sp/>has<sp/>changed.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="454"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1ac4046b7ff870a361f075cda0e1f872d1" kindref="member">WriteLn</ref>(f</highlight><highlight class="stringliteral">&quot;{output}:<sp/>{main_output}<sp/>;&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="455"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1ac4046b7ff870a361f075cda0e1f872d1" kindref="member">WriteLn</ref>()</highlight></codeline>
<codeline lineno="456"><highlight class="normal"></highlight></codeline>
<codeline lineno="457"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1ac4046b7ff870a361f075cda0e1f872d1" kindref="member">WriteLn</ref>()</highlight></codeline>
<codeline lineno="458"><highlight class="normal"></highlight></codeline>
<codeline lineno="459" refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1a620445f975ae8b4f85b42c73fdb18d91" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1a620445f975ae8b4f85b42c73fdb18d91" kindref="member">WriteCopies</ref>(self,<sp/>copies,<sp/>extra_outputs):</highlight></codeline>
<codeline lineno="460"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Write<sp/>Makefile<sp/>code<sp/>for<sp/>any<sp/>&apos;copies&apos;<sp/>from<sp/>the<sp/>gyp<sp/>input.</highlight></codeline>
<codeline lineno="461"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="462"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>extra_outputs:<sp/>a<sp/>list<sp/>that<sp/>will<sp/>be<sp/>filled<sp/>in<sp/>with<sp/>any<sp/>outputs<sp/>of<sp/>this<sp/>action</highlight></codeline>
<codeline lineno="463"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(used<sp/>to<sp/>make<sp/>other<sp/>pieces<sp/>dependent<sp/>on<sp/>this<sp/>action)</highlight></codeline>
<codeline lineno="464"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="465"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1ac4046b7ff870a361f075cda0e1f872d1" kindref="member">WriteLn</ref>(</highlight><highlight class="stringliteral">&quot;###<sp/>Generated<sp/>for<sp/>copy<sp/>rule.&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="466"><highlight class="normal"></highlight></codeline>
<codeline lineno="467"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>variable<sp/>=<sp/>make.StringToMakefileVariable(self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1a433fbe25872fab1a7ef1f7c9824d189e" kindref="member">relative_target</ref><sp/>+<sp/></highlight><highlight class="stringliteral">&quot;_copies&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="468"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>outputs<sp/>=<sp/>[]</highlight></codeline>
<codeline lineno="469"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>copy<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>copies:</highlight></codeline>
<codeline lineno="470"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>path<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>copy[</highlight><highlight class="stringliteral">&quot;files&quot;</highlight><highlight class="normal">]:</highlight></codeline>
<codeline lineno="471"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>The<sp/>Android<sp/>build<sp/>system<sp/>does<sp/>not<sp/>allow<sp/>generation<sp/>of<sp/>files<sp/>into<sp/>the</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="472"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>source<sp/>tree.<sp/>The<sp/>destination<sp/>should<sp/>start<sp/>with<sp/>a<sp/>variable,<sp/>which<sp/>will</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="473"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>typically<sp/>be<sp/>$(gyp_intermediate_dir)<sp/>or</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="474"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>$(gyp_shared_intermediate_dir).<sp/>Note<sp/>that<sp/>we<sp/>can&apos;t<sp/>use<sp/>an<sp/>assertion</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="475"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>because<sp/>some<sp/>of<sp/>the<sp/>gyp<sp/>tests<sp/>depend<sp/>on<sp/>this.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="476"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>copy[</highlight><highlight class="stringliteral">&quot;destination&quot;</highlight><highlight class="normal">].startswith(</highlight><highlight class="stringliteral">&quot;$&quot;</highlight><highlight class="normal">):</highlight></codeline>
<codeline lineno="477"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>print(</highlight></codeline>
<codeline lineno="478"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;WARNING:<sp/>Copy<sp/>rule<sp/>for<sp/>target<sp/>%s<sp/>writes<sp/>output<sp/>to<sp/>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="479"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;local<sp/>path<sp/>%s&quot;</highlight><highlight class="normal"><sp/>%<sp/>(self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1a5e68bf68b8950fe2ac3038c730477682" kindref="member">target</ref>,<sp/>copy[</highlight><highlight class="stringliteral">&quot;destination&quot;</highlight><highlight class="normal">])</highlight></codeline>
<codeline lineno="480"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>)</highlight></codeline>
<codeline lineno="481"><highlight class="normal"></highlight></codeline>
<codeline lineno="482"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>LocalPathify()<sp/>calls<sp/>normpath,<sp/>stripping<sp/>trailing<sp/>slashes.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="483"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>path<sp/>=<sp/><ref refid="namespacegyp_1_1generator_1_1android_1a27b0bbc0fc0a6154ceebf7b4224fa7bf" kindref="member">Sourceify</ref>(self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1a172c16217eab4fca1017c7d4fabcbf1d" kindref="member">LocalPathify</ref><ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1aadd56929484e5da3d614414dbb9bcd30" kindref="member">LocalPathify</ref>(path))</highlight></codeline>
<codeline lineno="484"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>filename<sp/>=<sp/>os.path.split(path)[1]</highlight></codeline>
<codeline lineno="485"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>output<sp/>=<sp/><ref refid="namespacegyp_1_1generator_1_1android_1a27b0bbc0fc0a6154ceebf7b4224fa7bf" kindref="member">Sourceify</ref>(</highlight></codeline>
<codeline lineno="486"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1a172c16217eab4fca1017c7d4fabcbf1d" kindref="member">LocalPathify</ref><ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1aadd56929484e5da3d614414dbb9bcd30" kindref="member">LocalPathify</ref>(os.path.join(copy[</highlight><highlight class="stringliteral">&quot;destination&quot;</highlight><highlight class="normal">],<sp/>filename))</highlight></codeline>
<codeline lineno="487"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>)</highlight></codeline>
<codeline lineno="488"><highlight class="normal"></highlight></codeline>
<codeline lineno="489"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1ac4046b7ff870a361f075cda0e1f872d1" kindref="member">WriteLn</ref>(f</highlight><highlight class="stringliteral">&quot;{output}:<sp/>{path}<sp/>$(GYP_TARGET_DEPENDENCIES)<sp/>|<sp/>$(ACP)&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="490"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1ac4046b7ff870a361f075cda0e1f872d1" kindref="member">WriteLn</ref>(</highlight><highlight class="stringliteral">&quot;\t@echo<sp/>Copying:<sp/>$@&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="491"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1ac4046b7ff870a361f075cda0e1f872d1" kindref="member">WriteLn</ref>(</highlight><highlight class="stringliteral">&quot;\t$(hide)<sp/>mkdir<sp/>-p<sp/>$(dir<sp/>$@)&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="492"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1ac4046b7ff870a361f075cda0e1f872d1" kindref="member">WriteLn</ref>(</highlight><highlight class="stringliteral">&quot;\t$(hide)<sp/>$(ACP)<sp/>-rpf<sp/>$&lt;<sp/>$@&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="493"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1ac4046b7ff870a361f075cda0e1f872d1" kindref="member">WriteLn</ref>()</highlight></codeline>
<codeline lineno="494"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>outputs.append(output)</highlight></codeline>
<codeline lineno="495"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1ac4046b7ff870a361f075cda0e1f872d1" kindref="member">WriteLn</ref>(</highlight></codeline>
<codeline lineno="496"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;{}<sp/>=<sp/>{}&quot;</highlight><highlight class="normal">.format(variable,<sp/></highlight><highlight class="stringliteral">&quot;<sp/>&quot;</highlight><highlight class="normal">.join(map(make.QuoteSpaces,<sp/>outputs)))</highlight></codeline>
<codeline lineno="497"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>)</highlight></codeline>
<codeline lineno="498"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>extra_outputs.append(</highlight><highlight class="stringliteral">&quot;$(%s)&quot;</highlight><highlight class="normal"><sp/>%<sp/>variable)</highlight></codeline>
<codeline lineno="499"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1ac4046b7ff870a361f075cda0e1f872d1" kindref="member">WriteLn</ref>()</highlight></codeline>
<codeline lineno="500"><highlight class="normal"></highlight></codeline>
<codeline lineno="501" refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1a65f831615239ac27ad9bbac6cbb67573" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1a65f831615239ac27ad9bbac6cbb67573" kindref="member">WriteSourceFlags</ref>(self,<sp/>spec,<sp/>configs):</highlight></codeline>
<codeline lineno="502"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Write<sp/>out<sp/>the<sp/>flags<sp/>and<sp/>include<sp/>paths<sp/>used<sp/>to<sp/>compile<sp/>source<sp/>files<sp/>for</highlight></codeline>
<codeline lineno="503"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>the<sp/>current<sp/>target.</highlight></codeline>
<codeline lineno="504"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="505"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Args:</highlight></codeline>
<codeline lineno="506"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>spec,<sp/>configs:<sp/>input<sp/>from<sp/>gyp.</highlight></codeline>
<codeline lineno="507"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="508"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>configname,<sp/>config<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>sorted(configs.items()):</highlight></codeline>
<codeline lineno="509"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>extracted_includes<sp/>=<sp/>[]</highlight></codeline>
<codeline lineno="510"><highlight class="normal"></highlight></codeline>
<codeline lineno="511"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1ac4046b7ff870a361f075cda0e1f872d1" kindref="member">WriteLn</ref>(</highlight><highlight class="stringliteral">&quot;\n#<sp/>Flags<sp/>passed<sp/>to<sp/>both<sp/>C<sp/>and<sp/>C++<sp/>files.&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="512"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cflags,<sp/>includes_from_cflags<sp/>=<sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1a027b4c5c23a05d6eafc608c389332717" kindref="member">ExtractIncludesFromCFlags</ref>(</highlight></codeline>
<codeline lineno="513"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>config.get(</highlight><highlight class="stringliteral">&quot;cflags&quot;</highlight><highlight class="normal">,<sp/>[])<sp/>+<sp/>config.get(</highlight><highlight class="stringliteral">&quot;cflags_c&quot;</highlight><highlight class="normal">,<sp/>[])</highlight></codeline>
<codeline lineno="514"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>)</highlight></codeline>
<codeline lineno="515"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>extracted_includes.extend(includes_from_cflags)</highlight></codeline>
<codeline lineno="516"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1a043072c186835f10859fccfc7409e708" kindref="member">WriteList</ref>(cflags,<sp/></highlight><highlight class="stringliteral">&quot;MY_CFLAGS_%s&quot;</highlight><highlight class="normal"><sp/>%<sp/>configname)</highlight></codeline>
<codeline lineno="517"><highlight class="normal"></highlight></codeline>
<codeline lineno="518"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1a043072c186835f10859fccfc7409e708" kindref="member">WriteList</ref>(</highlight></codeline>
<codeline lineno="519"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>config.get(</highlight><highlight class="stringliteral">&quot;defines&quot;</highlight><highlight class="normal">),</highlight></codeline>
<codeline lineno="520"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;MY_DEFS_%s&quot;</highlight><highlight class="normal"><sp/>%<sp/>configname,</highlight></codeline>
<codeline lineno="521"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>prefix=</highlight><highlight class="stringliteral">&quot;-D&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="522"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>quoter=make.EscapeCppDefine,</highlight></codeline>
<codeline lineno="523"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>)</highlight></codeline>
<codeline lineno="524"><highlight class="normal"></highlight></codeline>
<codeline lineno="525"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1ac4046b7ff870a361f075cda0e1f872d1" kindref="member">WriteLn</ref>(</highlight><highlight class="stringliteral">&quot;\n#<sp/>Include<sp/>paths<sp/>placed<sp/>before<sp/>CFLAGS/CPPFLAGS&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="526"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>includes<sp/>=<sp/>list(config.get(</highlight><highlight class="stringliteral">&quot;include_dirs&quot;</highlight><highlight class="normal">,<sp/>[]))</highlight></codeline>
<codeline lineno="527"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>includes.extend(extracted_includes)</highlight></codeline>
<codeline lineno="528"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>includes<sp/>=<sp/>map(Sourceify,<sp/>map(self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1a172c16217eab4fca1017c7d4fabcbf1d" kindref="member">LocalPathify</ref><ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1aadd56929484e5da3d614414dbb9bcd30" kindref="member">LocalPathify</ref>,<sp/>includes))</highlight></codeline>
<codeline lineno="529"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>includes<sp/>=<sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1a6ea64d33b7b23f21b567d28b21a50f0a" kindref="member">NormalizeIncludePaths</ref>(includes)</highlight></codeline>
<codeline lineno="530"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1a043072c186835f10859fccfc7409e708" kindref="member">WriteList</ref>(includes,<sp/></highlight><highlight class="stringliteral">&quot;LOCAL_C_INCLUDES_%s&quot;</highlight><highlight class="normal"><sp/>%<sp/>configname)</highlight></codeline>
<codeline lineno="531"><highlight class="normal"></highlight></codeline>
<codeline lineno="532"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1ac4046b7ff870a361f075cda0e1f872d1" kindref="member">WriteLn</ref>(</highlight><highlight class="stringliteral">&quot;\n#<sp/>Flags<sp/>passed<sp/>to<sp/>only<sp/>C++<sp/>(and<sp/>not<sp/>C)<sp/>files.&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="533"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1a043072c186835f10859fccfc7409e708" kindref="member">WriteList</ref>(config.get(</highlight><highlight class="stringliteral">&quot;cflags_cc&quot;</highlight><highlight class="normal">),<sp/></highlight><highlight class="stringliteral">&quot;LOCAL_CPPFLAGS_%s&quot;</highlight><highlight class="normal"><sp/>%<sp/>configname)</highlight></codeline>
<codeline lineno="534"><highlight class="normal"></highlight></codeline>
<codeline lineno="535"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1ac4046b7ff870a361f075cda0e1f872d1" kindref="member">WriteLn</ref>(</highlight></codeline>
<codeline lineno="536"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;\nLOCAL_CFLAGS<sp/>:=<sp/>$(MY_CFLAGS_$(GYP_CONFIGURATION))<sp/>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="537"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;$(MY_DEFS_$(GYP_CONFIGURATION))&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="538"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>)</highlight></codeline>
<codeline lineno="539"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>Undefine<sp/>ANDROID<sp/>for<sp/>host<sp/>modules</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="540"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>TODO:<sp/>the<sp/>source<sp/>code<sp/>should<sp/>not<sp/>use<sp/>macro<sp/>ANDROID<sp/>to<sp/>tell<sp/>if<sp/>it&apos;s<sp/>host</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="541"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>or<sp/>target<sp/>module.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="542"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1aac067c5ee71afa848000a1f5e0138be1" kindref="member">toolset</ref><sp/>==<sp/></highlight><highlight class="stringliteral">&quot;host&quot;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="543"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1ac4046b7ff870a361f075cda0e1f872d1" kindref="member">WriteLn</ref>(</highlight><highlight class="stringliteral">&quot;#<sp/>Undefine<sp/>ANDROID<sp/>for<sp/>host<sp/>modules&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="544"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1ac4046b7ff870a361f075cda0e1f872d1" kindref="member">WriteLn</ref>(</highlight><highlight class="stringliteral">&quot;LOCAL_CFLAGS<sp/>+=<sp/>-UANDROID&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="545"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1ac4046b7ff870a361f075cda0e1f872d1" kindref="member">WriteLn</ref>(</highlight></codeline>
<codeline lineno="546"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;LOCAL_C_INCLUDES<sp/>:=<sp/>$(GYP_COPIED_SOURCE_ORIGIN_DIRS)<sp/>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="547"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;$(LOCAL_C_INCLUDES_$(GYP_CONFIGURATION))&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="548"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>)</highlight></codeline>
<codeline lineno="549"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1ac4046b7ff870a361f075cda0e1f872d1" kindref="member">WriteLn</ref>(</highlight><highlight class="stringliteral">&quot;LOCAL_CPPFLAGS<sp/>:=<sp/>$(LOCAL_CPPFLAGS_$(GYP_CONFIGURATION))&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="550"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>Android<sp/>uses<sp/>separate<sp/>flags<sp/>for<sp/>assembly<sp/>file<sp/>invocations,<sp/>but<sp/>gyp<sp/>expects</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="551"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>the<sp/>same<sp/>CFLAGS<sp/>to<sp/>be<sp/>applied:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="552"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1ac4046b7ff870a361f075cda0e1f872d1" kindref="member">WriteLn</ref>(</highlight><highlight class="stringliteral">&quot;LOCAL_ASFLAGS<sp/>:=<sp/>$(LOCAL_CFLAGS)&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="553"><highlight class="normal"></highlight></codeline>
<codeline lineno="554" refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1aa5b0a2d998b448f503c8f46f034d50c5" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1aa5b0a2d998b448f503c8f46f034d50c5" kindref="member">WriteSources</ref>(self,<sp/>spec,<sp/>configs,<sp/>extra_sources):</highlight></codeline>
<codeline lineno="555"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Write<sp/>Makefile<sp/>code<sp/>for<sp/>any<sp/>&apos;sources&apos;<sp/>from<sp/>the<sp/>gyp<sp/>input.</highlight></codeline>
<codeline lineno="556"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>These<sp/>are<sp/>source<sp/>files<sp/>necessary<sp/>to<sp/>build<sp/>the<sp/>current<sp/>target.</highlight></codeline>
<codeline lineno="557"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>We<sp/>need<sp/>to<sp/>handle<sp/>shared_intermediate<sp/>directory<sp/>source<sp/>files<sp/>as</highlight></codeline>
<codeline lineno="558"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>a<sp/>special<sp/>case<sp/>by<sp/>copying<sp/>them<sp/>to<sp/>the<sp/>intermediate<sp/>directory<sp/>and</highlight></codeline>
<codeline lineno="559"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>treating<sp/>them<sp/>as<sp/>a<sp/>generated<sp/>sources.<sp/>Otherwise<sp/>the<sp/>Android<sp/>build</highlight></codeline>
<codeline lineno="560"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rules<sp/>won&apos;t<sp/>pick<sp/>them<sp/>up.</highlight></codeline>
<codeline lineno="561"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="562"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Args:</highlight></codeline>
<codeline lineno="563"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>spec,<sp/>configs:<sp/>input<sp/>from<sp/>gyp.</highlight></codeline>
<codeline lineno="564"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>extra_sources:<sp/>Sources<sp/>generated<sp/>from<sp/>Actions<sp/>or<sp/>Rules.</highlight></codeline>
<codeline lineno="565"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="566"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sources<sp/>=<sp/>filter(make.Compilable,<sp/>spec.get(</highlight><highlight class="stringliteral">&quot;sources&quot;</highlight><highlight class="normal">,<sp/>[]))</highlight></codeline>
<codeline lineno="567"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>generated_not_sources<sp/>=<sp/>[x<sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>x<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>extra_sources<sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>make.Compilable(x)]</highlight></codeline>
<codeline lineno="568"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>extra_sources<sp/>=<sp/>filter(make.Compilable,<sp/>extra_sources)</highlight></codeline>
<codeline lineno="569"><highlight class="normal"></highlight></codeline>
<codeline lineno="570"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>Determine<sp/>and<sp/>output<sp/>the<sp/>C++<sp/>extension<sp/>used<sp/>by<sp/>these<sp/>sources.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="571"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>We<sp/>simply<sp/>find<sp/>the<sp/>first<sp/>C++<sp/>file<sp/>and<sp/>use<sp/>that<sp/>extension.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="572"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>all_sources<sp/>=<sp/>sources<sp/>+<sp/>extra_sources</highlight></codeline>
<codeline lineno="573"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>local_cpp_extension<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;.cpp&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="574"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>source<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>all_sources:</highlight></codeline>
<codeline lineno="575"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(root,<sp/>ext)<sp/>=<sp/>os.path.splitext(source)</highlight></codeline>
<codeline lineno="576"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/><ref refid="namespacegyp_1_1generator_1_1android_1ad50d2d1fc93ec0e72637c4c4f60c1cc7" kindref="member">IsCPPExtension</ref>(ext):</highlight></codeline>
<codeline lineno="577"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>local_cpp_extension<sp/>=<sp/>ext</highlight></codeline>
<codeline lineno="578"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="579"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>local_cpp_extension<sp/>!=<sp/></highlight><highlight class="stringliteral">&quot;.cpp&quot;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="580"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1ac4046b7ff870a361f075cda0e1f872d1" kindref="member">WriteLn</ref>(</highlight><highlight class="stringliteral">&quot;LOCAL_CPP_EXTENSION<sp/>:=<sp/>%s&quot;</highlight><highlight class="normal"><sp/>%<sp/>local_cpp_extension)</highlight></codeline>
<codeline lineno="581"><highlight class="normal"></highlight></codeline>
<codeline lineno="582"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>We<sp/>need<sp/>to<sp/>move<sp/>any<sp/>non-generated<sp/>sources<sp/>that<sp/>are<sp/>coming<sp/>from<sp/>the</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="583"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>shared<sp/>intermediate<sp/>directory<sp/>out<sp/>of<sp/>LOCAL_SRC_FILES<sp/>and<sp/>put<sp/>them</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="584"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>into<sp/>LOCAL_GENERATED_SOURCES.<sp/>We<sp/>also<sp/>need<sp/>to<sp/>move<sp/>over<sp/>any<sp/>C++<sp/>files</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="585"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>that<sp/>don&apos;t<sp/>match<sp/>our<sp/>local_cpp_extension,<sp/>since<sp/>Android<sp/>will<sp/>only</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="586"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>generate<sp/>Makefile<sp/>rules<sp/>for<sp/>a<sp/>single<sp/>LOCAL_CPP_EXTENSION.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="587"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>local_files<sp/>=<sp/>[]</highlight></codeline>
<codeline lineno="588"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>source<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>sources:</highlight></codeline>
<codeline lineno="589"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(root,<sp/>ext)<sp/>=<sp/>os.path.splitext(source)</highlight></codeline>
<codeline lineno="590"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&quot;$(gyp_shared_intermediate_dir)&quot;</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>source:</highlight></codeline>
<codeline lineno="591"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>extra_sources.append(source)</highlight></codeline>
<codeline lineno="592"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&quot;$(gyp_intermediate_dir)&quot;</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>source:</highlight></codeline>
<codeline lineno="593"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>extra_sources.append(source)</highlight></codeline>
<codeline lineno="594"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/><ref refid="namespacegyp_1_1generator_1_1android_1ad50d2d1fc93ec0e72637c4c4f60c1cc7" kindref="member">IsCPPExtension</ref>(ext)<sp/></highlight><highlight class="keywordflow">and</highlight><highlight class="normal"><sp/>ext<sp/>!=<sp/>local_cpp_extension:</highlight></codeline>
<codeline lineno="595"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>extra_sources.append(source)</highlight></codeline>
<codeline lineno="596"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="597"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>local_files.append(os.path.normpath(os.path.join(self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1aa40cc309d9d8adc770d83510757dc0cb" kindref="member">path</ref>,<sp/>source)))</highlight></codeline>
<codeline lineno="598"><highlight class="normal"></highlight></codeline>
<codeline lineno="599"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>For<sp/>any<sp/>generated<sp/>source,<sp/>if<sp/>it<sp/>is<sp/>coming<sp/>from<sp/>the<sp/>shared<sp/>intermediate</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="600"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>directory<sp/>then<sp/>we<sp/>add<sp/>a<sp/>Make<sp/>rule<sp/>to<sp/>copy<sp/>them<sp/>to<sp/>the<sp/>local<sp/>intermediate</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="601"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>directory<sp/>first.<sp/>This<sp/>is<sp/>because<sp/>the<sp/>Android<sp/>LOCAL_GENERATED_SOURCES</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="602"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>must<sp/>be<sp/>in<sp/>the<sp/>local<sp/>module<sp/>intermediate<sp/>directory<sp/>for<sp/>the<sp/>compile<sp/>rules</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="603"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>to<sp/>work<sp/>properly.<sp/>If<sp/>the<sp/>file<sp/>has<sp/>the<sp/>wrong<sp/>C++<sp/>extension,<sp/>then<sp/>we<sp/>add</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="604"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>a<sp/>rule<sp/>to<sp/>copy<sp/>that<sp/>to<sp/>intermediates<sp/>and<sp/>use<sp/>the<sp/>new<sp/>version.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="605"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>final_generated_sources<sp/>=<sp/>[]</highlight></codeline>
<codeline lineno="606"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>If<sp/>a<sp/>source<sp/>file<sp/>gets<sp/>copied,<sp/>we<sp/>still<sp/>need<sp/>to<sp/>add<sp/>the<sp/>original<sp/>source</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="607"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>directory<sp/>as<sp/>header<sp/>search<sp/>path,<sp/>for<sp/>GCC<sp/>searches<sp/>headers<sp/>in<sp/>the</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="608"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>directory<sp/>that<sp/>contains<sp/>the<sp/>source<sp/>file<sp/>by<sp/>default.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="609"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>origin_src_dirs<sp/>=<sp/>[]</highlight></codeline>
<codeline lineno="610"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>source<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>extra_sources:</highlight></codeline>
<codeline lineno="611"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>local_file<sp/>=<sp/>source</highlight></codeline>
<codeline lineno="612"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&quot;$(gyp_intermediate_dir)/&quot;</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>local_file:</highlight></codeline>
<codeline lineno="613"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>basename<sp/>=<sp/>os.path.basename(local_file)</highlight></codeline>
<codeline lineno="614"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>local_file<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;$(gyp_intermediate_dir)/&quot;</highlight><highlight class="normal"><sp/>+<sp/>basename</highlight></codeline>
<codeline lineno="615"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(root,<sp/>ext)<sp/>=<sp/>os.path.splitext(local_file)</highlight></codeline>
<codeline lineno="616"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/><ref refid="namespacegyp_1_1generator_1_1android_1ad50d2d1fc93ec0e72637c4c4f60c1cc7" kindref="member">IsCPPExtension</ref>(ext)<sp/></highlight><highlight class="keywordflow">and</highlight><highlight class="normal"><sp/>ext<sp/>!=<sp/>local_cpp_extension:</highlight></codeline>
<codeline lineno="617"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>local_file<sp/>=<sp/>root<sp/>+<sp/>local_cpp_extension</highlight></codeline>
<codeline lineno="618"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>local_file<sp/>!=<sp/>source:</highlight></codeline>
<codeline lineno="619"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1ac4046b7ff870a361f075cda0e1f872d1" kindref="member">WriteLn</ref>(f</highlight><highlight class="stringliteral">&quot;{local_file}:<sp/>{self.LocalPathify(source)}&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="620"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1ac4046b7ff870a361f075cda0e1f872d1" kindref="member">WriteLn</ref>(</highlight><highlight class="stringliteral">&quot;\tmkdir<sp/>-p<sp/>$(@D);<sp/>cp<sp/>$&lt;<sp/>$@&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="621"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>origin_src_dirs.append(os.path.dirname(source))</highlight></codeline>
<codeline lineno="622"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>final_generated_sources.append(local_file)</highlight></codeline>
<codeline lineno="623"><highlight class="normal"></highlight></codeline>
<codeline lineno="624"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>We<sp/>add<sp/>back<sp/>in<sp/>all<sp/>of<sp/>the<sp/>non-compilable<sp/>stuff<sp/>to<sp/>make<sp/>sure<sp/>that<sp/>the</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="625"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>make<sp/>rules<sp/>have<sp/>dependencies<sp/>on<sp/>them.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="626"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>final_generated_sources.extend(generated_not_sources)</highlight></codeline>
<codeline lineno="627"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1a043072c186835f10859fccfc7409e708" kindref="member">WriteList</ref>(final_generated_sources,<sp/></highlight><highlight class="stringliteral">&quot;LOCAL_GENERATED_SOURCES&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="628"><highlight class="normal"></highlight></codeline>
<codeline lineno="629"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>origin_src_dirs<sp/>=<sp/><ref refid="namespacegyp_1_1common_1ad189f1004790fca1b7cdfc7c01dde48f" kindref="member">gyp.common.uniquer</ref>(origin_src_dirs)</highlight></codeline>
<codeline lineno="630"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>origin_src_dirs<sp/>=<sp/>map(Sourceify,<sp/>map(self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1a172c16217eab4fca1017c7d4fabcbf1d" kindref="member">LocalPathify</ref><ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1aadd56929484e5da3d614414dbb9bcd30" kindref="member">LocalPathify</ref>,<sp/>origin_src_dirs))</highlight></codeline>
<codeline lineno="631"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1a043072c186835f10859fccfc7409e708" kindref="member">WriteList</ref>(origin_src_dirs,<sp/></highlight><highlight class="stringliteral">&quot;GYP_COPIED_SOURCE_ORIGIN_DIRS&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="632"><highlight class="normal"></highlight></codeline>
<codeline lineno="633"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1a043072c186835f10859fccfc7409e708" kindref="member">WriteList</ref>(local_files,<sp/></highlight><highlight class="stringliteral">&quot;LOCAL_SRC_FILES&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="634"><highlight class="normal"></highlight></codeline>
<codeline lineno="635"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>Write<sp/>out<sp/>the<sp/>flags<sp/>used<sp/>to<sp/>compile<sp/>the<sp/>source;<sp/>this<sp/>must<sp/>be<sp/>done<sp/>last</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="636"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>so<sp/>that<sp/>GYP_COPIED_SOURCE_ORIGIN_DIRS<sp/>can<sp/>be<sp/>used<sp/>as<sp/>an<sp/>include<sp/>path.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="637"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1a65f831615239ac27ad9bbac6cbb67573" kindref="member">WriteSourceFlags</ref>(spec,<sp/>configs)</highlight></codeline>
<codeline lineno="638"><highlight class="normal"></highlight></codeline>
<codeline lineno="639" refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1ac7fa7e6545954db5532c4dd8eaeed452" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1ac7fa7e6545954db5532c4dd8eaeed452" kindref="member">ComputeAndroidModule</ref>(self,<sp/>spec):</highlight></codeline>
<codeline lineno="640"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Return<sp/>the<sp/>Android<sp/>module<sp/>name<sp/>used<sp/>for<sp/>a<sp/>gyp<sp/>spec.</highlight></codeline>
<codeline lineno="641"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="642"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>We<sp/>use<sp/>the<sp/>complete<sp/>qualified<sp/>target<sp/>name<sp/>to<sp/>avoid<sp/>collisions<sp/>between</highlight></codeline>
<codeline lineno="643"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>duplicate<sp/>targets<sp/>in<sp/>different<sp/>directories.<sp/>We<sp/>also<sp/>add<sp/>a<sp/>suffix<sp/>to</highlight></codeline>
<codeline lineno="644"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>distinguish<sp/>gyp-generated<sp/>module<sp/>names.</highlight></codeline>
<codeline lineno="645"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="646"><highlight class="normal"></highlight></codeline>
<codeline lineno="647"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>int(spec.get(</highlight><highlight class="stringliteral">&quot;android_unmangled_name&quot;</highlight><highlight class="normal">,<sp/>0)):</highlight></codeline>
<codeline lineno="648"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">assert</highlight><highlight class="normal"><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1a6d061a84eb6f6ab0d1dfeabd0ea61f04" kindref="member">type</ref><sp/>!=<sp/></highlight><highlight class="stringliteral">&quot;shared_library&quot;</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">or</highlight><highlight class="normal"><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1a5e68bf68b8950fe2ac3038c730477682" kindref="member">target</ref>.startswith(</highlight><highlight class="stringliteral">&quot;lib&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="649"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1a5e68bf68b8950fe2ac3038c730477682" kindref="member">target</ref></highlight></codeline>
<codeline lineno="650"><highlight class="normal"></highlight></codeline>
<codeline lineno="651"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1a6d061a84eb6f6ab0d1dfeabd0ea61f04" kindref="member">type</ref><sp/>==<sp/></highlight><highlight class="stringliteral">&quot;shared_library&quot;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="652"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>For<sp/>reasons<sp/>of<sp/>convention,<sp/>the<sp/>Android<sp/>build<sp/>system<sp/>requires<sp/>that<sp/>all</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="653"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>shared<sp/>library<sp/>modules<sp/>are<sp/>named<sp/>&apos;libfoo&apos;<sp/>when<sp/>generating<sp/>-l<sp/>flags.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="654"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>prefix<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;lib_&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="655"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="656"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>prefix<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="657"><highlight class="normal"></highlight></codeline>
<codeline lineno="658"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>spec[</highlight><highlight class="stringliteral">&quot;toolset&quot;</highlight><highlight class="normal">]<sp/>==<sp/></highlight><highlight class="stringliteral">&quot;host&quot;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="659"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>suffix<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;_$(TARGET_$(GYP_VAR_PREFIX)ARCH)_host_gyp&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="660"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="661"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>suffix<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;_gyp&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="662"><highlight class="normal"></highlight></codeline>
<codeline lineno="663"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1aa40cc309d9d8adc770d83510757dc0cb" kindref="member">path</ref>:</highlight></codeline>
<codeline lineno="664"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>middle<sp/>=<sp/>make.StringToMakefileVariable(f</highlight><highlight class="stringliteral">&quot;{self.path}_{self.target}&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="665"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="666"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>middle<sp/>=<sp/>make.StringToMakefileVariable(self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1a5e68bf68b8950fe2ac3038c730477682" kindref="member">target</ref>)</highlight></codeline>
<codeline lineno="667"><highlight class="normal"></highlight></codeline>
<codeline lineno="668"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&quot;&quot;</highlight><highlight class="normal">.join([prefix,<sp/>middle,<sp/>suffix])</highlight></codeline>
<codeline lineno="669"><highlight class="normal"></highlight></codeline>
<codeline lineno="670" refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1ab734f66c93811de4be017ffbfbb05b73" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1ab734f66c93811de4be017ffbfbb05b73" kindref="member">ComputeOutputParts</ref>(self,<sp/>spec):</highlight></codeline>
<codeline lineno="671"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Return<sp/>the<sp/>&apos;output<sp/>basename&apos;<sp/>of<sp/>a<sp/>gyp<sp/>spec,<sp/>split<sp/>into<sp/>filename<sp/>+<sp/>ext.</highlight></codeline>
<codeline lineno="672"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="673"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Android<sp/>libraries<sp/>must<sp/>be<sp/>named<sp/>the<sp/>same<sp/>thing<sp/>as<sp/>their<sp/>module<sp/>name,</highlight></codeline>
<codeline lineno="674"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>otherwise<sp/>the<sp/>linker<sp/>can&apos;t<sp/>find<sp/>them,<sp/>so<sp/>product_name<sp/>and<sp/>so<sp/>on<sp/>must<sp/>be</highlight></codeline>
<codeline lineno="675"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ignored<sp/>if<sp/>we<sp/>are<sp/>building<sp/>a<sp/>library,<sp/>and<sp/>the<sp/>&quot;lib&quot;<sp/>prepending<sp/>is</highlight></codeline>
<codeline lineno="676"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>not<sp/>done<sp/>for<sp/>Android.</highlight></codeline>
<codeline lineno="677"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="678"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">assert</highlight><highlight class="normal"><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1a6d061a84eb6f6ab0d1dfeabd0ea61f04" kindref="member">type</ref><sp/>!=<sp/></highlight><highlight class="stringliteral">&quot;loadable_module&quot;</highlight><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">#<sp/>TODO:<sp/>not<sp/>supported?</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="679"><highlight class="normal"></highlight></codeline>
<codeline lineno="680"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>target<sp/>=<sp/>spec[</highlight><highlight class="stringliteral">&quot;target_name&quot;</highlight><highlight class="normal">]</highlight></codeline>
<codeline lineno="681"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>target_prefix<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="682"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>target_ext<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="683"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1a6d061a84eb6f6ab0d1dfeabd0ea61f04" kindref="member">type</ref><sp/>==<sp/></highlight><highlight class="stringliteral">&quot;static_library&quot;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="684"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>target<sp/>=<sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1ac7fa7e6545954db5532c4dd8eaeed452" kindref="member">ComputeAndroidModule</ref>(spec)</highlight></codeline>
<codeline lineno="685"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>target_ext<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;.a&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="686"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1a6d061a84eb6f6ab0d1dfeabd0ea61f04" kindref="member">type</ref><sp/>==<sp/></highlight><highlight class="stringliteral">&quot;shared_library&quot;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="687"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>target<sp/>=<sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1ac7fa7e6545954db5532c4dd8eaeed452" kindref="member">ComputeAndroidModule</ref>(spec)</highlight></codeline>
<codeline lineno="688"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>target_ext<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;.so&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="689"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1a6d061a84eb6f6ab0d1dfeabd0ea61f04" kindref="member">type</ref><sp/>==<sp/></highlight><highlight class="stringliteral">&quot;none&quot;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="690"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>target_ext<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;.stamp&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="691"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1a6d061a84eb6f6ab0d1dfeabd0ea61f04" kindref="member">type</ref><sp/>!=<sp/></highlight><highlight class="stringliteral">&quot;executable&quot;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="692"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>print(</highlight></codeline>
<codeline lineno="693"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;ERROR:<sp/>What<sp/>output<sp/>file<sp/>should<sp/>be<sp/>generated?&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="694"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;type&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="695"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1a6d061a84eb6f6ab0d1dfeabd0ea61f04" kindref="member">type</ref>,</highlight></codeline>
<codeline lineno="696"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;target&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="697"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>target,</highlight></codeline>
<codeline lineno="698"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>)</highlight></codeline>
<codeline lineno="699"><highlight class="normal"></highlight></codeline>
<codeline lineno="700"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1a6d061a84eb6f6ab0d1dfeabd0ea61f04" kindref="member">type</ref><sp/>!=<sp/></highlight><highlight class="stringliteral">&quot;static_library&quot;</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">and</highlight><highlight class="normal"><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1a6d061a84eb6f6ab0d1dfeabd0ea61f04" kindref="member">type</ref><sp/>!=<sp/></highlight><highlight class="stringliteral">&quot;shared_library&quot;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="701"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>target_prefix<sp/>=<sp/>spec.get(</highlight><highlight class="stringliteral">&quot;product_prefix&quot;</highlight><highlight class="normal">,<sp/>target_prefix)</highlight></codeline>
<codeline lineno="702"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>target<sp/>=<sp/>spec.get(</highlight><highlight class="stringliteral">&quot;product_name&quot;</highlight><highlight class="normal">,<sp/>target)</highlight></codeline>
<codeline lineno="703"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>product_ext<sp/>=<sp/>spec.get(</highlight><highlight class="stringliteral">&quot;product_extension&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="704"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>product_ext:</highlight></codeline>
<codeline lineno="705"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>target_ext<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;.&quot;</highlight><highlight class="normal"><sp/>+<sp/>product_ext</highlight></codeline>
<codeline lineno="706"><highlight class="normal"></highlight></codeline>
<codeline lineno="707"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>target_stem<sp/>=<sp/>target_prefix<sp/>+<sp/>target</highlight></codeline>
<codeline lineno="708"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>(target_stem,<sp/>target_ext)</highlight></codeline>
<codeline lineno="709"><highlight class="normal"></highlight></codeline>
<codeline lineno="710" refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1a85be7bdb4d3ce3ffac1e5a201be71bfc" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1a85be7bdb4d3ce3ffac1e5a201be71bfc" kindref="member">ComputeOutputBasename</ref>(self,<sp/>spec):</highlight></codeline>
<codeline lineno="711"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Return<sp/>the<sp/>&apos;output<sp/>basename&apos;<sp/>of<sp/>a<sp/>gyp<sp/>spec.</highlight></codeline>
<codeline lineno="712"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="713"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>E.g.,<sp/>the<sp/>loadable<sp/>module<sp/>&apos;foobar&apos;<sp/>in<sp/>directory<sp/>&apos;baz&apos;<sp/>will<sp/>produce</highlight></codeline>
<codeline lineno="714"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&apos;libfoobar.so&apos;</highlight></codeline>
<codeline lineno="715"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="716"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&quot;&quot;</highlight><highlight class="normal">.join(self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1ab734f66c93811de4be017ffbfbb05b73" kindref="member">ComputeOutputParts</ref>(spec))</highlight></codeline>
<codeline lineno="717"><highlight class="normal"></highlight></codeline>
<codeline lineno="718" refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1a79cc3f0ff504e5ae8b77c49ac871d47a" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1a79cc3f0ff504e5ae8b77c49ac871d47a" kindref="member">ComputeOutput</ref>(self,<sp/>spec):</highlight></codeline>
<codeline lineno="719"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Return<sp/>the<sp/>&apos;output&apos;<sp/>(full<sp/>output<sp/>path)<sp/>of<sp/>a<sp/>gyp<sp/>spec.</highlight></codeline>
<codeline lineno="720"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="721"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>E.g.,<sp/>the<sp/>loadable<sp/>module<sp/>&apos;foobar&apos;<sp/>in<sp/>directory<sp/>&apos;baz&apos;<sp/>will<sp/>produce</highlight></codeline>
<codeline lineno="722"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&apos;$(obj)/baz/libfoobar.so&apos;</highlight></codeline>
<codeline lineno="723"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="724"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1a6d061a84eb6f6ab0d1dfeabd0ea61f04" kindref="member">type</ref><sp/>==<sp/></highlight><highlight class="stringliteral">&quot;executable&quot;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="725"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>We<sp/>install<sp/>host<sp/>executables<sp/>into<sp/>shared_intermediate_dir<sp/>so<sp/>they<sp/>can<sp/>be</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="726"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>run<sp/>by<sp/>gyp<sp/>rules<sp/>that<sp/>refer<sp/>to<sp/>PRODUCT_DIR.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="727"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>path<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;$(gyp_shared_intermediate_dir)&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="728"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1a6d061a84eb6f6ab0d1dfeabd0ea61f04" kindref="member">type</ref><sp/>==<sp/></highlight><highlight class="stringliteral">&quot;shared_library&quot;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="729"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1aac067c5ee71afa848000a1f5e0138be1" kindref="member">toolset</ref><sp/>==<sp/></highlight><highlight class="stringliteral">&quot;host&quot;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="730"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>path<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;$($(GYP_HOST_VAR_PREFIX)HOST_OUT_INTERMEDIATE_LIBRARIES)&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="731"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="732"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>path<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;$($(GYP_VAR_PREFIX)TARGET_OUT_INTERMEDIATE_LIBRARIES)&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="733"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="734"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>Other<sp/>targets<sp/>just<sp/>get<sp/>built<sp/>into<sp/>their<sp/>intermediate<sp/>dir.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="735"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1aac067c5ee71afa848000a1f5e0138be1" kindref="member">toolset</ref><sp/>==<sp/></highlight><highlight class="stringliteral">&quot;host&quot;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="736"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>path<sp/>=<sp/>(</highlight></codeline>
<codeline lineno="737"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;$(call<sp/>intermediates-dir-for,%s,%s,true,,&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="738"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;$(GYP_HOST_VAR_PREFIX))&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="739"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>%<sp/>(self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1a56c63ff5c3056b84cee4565e01b7b74f" kindref="member">android_class</ref>,<sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1abfa6ab16aba8a08680d3397d4f55761f" kindref="member">android_module</ref>)</highlight></codeline>
<codeline lineno="740"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>)</highlight></codeline>
<codeline lineno="741"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="742"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>path<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;$(call<sp/>intermediates-dir-for,{},{},,,$(GYP_VAR_PREFIX))&quot;</highlight><highlight class="normal">.format(</highlight></codeline>
<codeline lineno="743"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1a56c63ff5c3056b84cee4565e01b7b74f" kindref="member">android_class</ref>,</highlight></codeline>
<codeline lineno="744"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1abfa6ab16aba8a08680d3397d4f55761f" kindref="member">android_module</ref>,</highlight></codeline>
<codeline lineno="745"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>)</highlight></codeline>
<codeline lineno="746"><highlight class="normal"></highlight></codeline>
<codeline lineno="747"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">assert</highlight><highlight class="normal"><sp/>spec.get(</highlight><highlight class="stringliteral">&quot;product_dir&quot;</highlight><highlight class="normal">)<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">#<sp/>TODO:<sp/>not<sp/>supported?</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="748"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>os.path.join(path,<sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1a85be7bdb4d3ce3ffac1e5a201be71bfc" kindref="member">ComputeOutputBasename</ref>(spec))</highlight></codeline>
<codeline lineno="749"><highlight class="normal"></highlight></codeline>
<codeline lineno="750" refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1a6ea64d33b7b23f21b567d28b21a50f0a" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1a6ea64d33b7b23f21b567d28b21a50f0a" kindref="member">NormalizeIncludePaths</ref>(self,<sp/>include_paths):</highlight></codeline>
<codeline lineno="751"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Normalize<sp/>include_paths.</highlight></codeline>
<codeline lineno="752"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Convert<sp/>absolute<sp/>paths<sp/>to<sp/>relative<sp/>to<sp/>the<sp/>Android<sp/>top<sp/>directory.</highlight></codeline>
<codeline lineno="753"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="754"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Args:</highlight></codeline>
<codeline lineno="755"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>include_paths:<sp/>A<sp/>list<sp/>of<sp/>unprocessed<sp/>include<sp/>paths.</highlight></codeline>
<codeline lineno="756"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Returns:</highlight></codeline>
<codeline lineno="757"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>A<sp/>list<sp/>of<sp/>normalized<sp/>include<sp/>paths.</highlight></codeline>
<codeline lineno="758"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="759"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>normalized<sp/>=<sp/>[]</highlight></codeline>
<codeline lineno="760"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>path<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>include_paths:</highlight></codeline>
<codeline lineno="761"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>path[0]<sp/>==<sp/></highlight><highlight class="stringliteral">&quot;/&quot;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="762"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>path<sp/>=<sp/><ref refid="namespacegyp_1_1common_1a8533ebdd9774c22ee7f7450c54239796" kindref="member">gyp.common.RelativePath</ref>(path,<sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1a8931c4ee94ed3001fd856ffe00353a2e" kindref="member">android_top_dir</ref>)</highlight></codeline>
<codeline lineno="763"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>normalized.append(path)</highlight></codeline>
<codeline lineno="764"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>normalized</highlight></codeline>
<codeline lineno="765"><highlight class="normal"></highlight></codeline>
<codeline lineno="766" refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1a027b4c5c23a05d6eafc608c389332717" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1a027b4c5c23a05d6eafc608c389332717" kindref="member">ExtractIncludesFromCFlags</ref>(self,<sp/>cflags):</highlight></codeline>
<codeline lineno="767"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Extract<sp/>includes<sp/>&quot;-I...&quot;<sp/>out<sp/>from<sp/>cflags</highlight></codeline>
<codeline lineno="768"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="769"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Args:</highlight></codeline>
<codeline lineno="770"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cflags:<sp/>A<sp/>list<sp/>of<sp/>compiler<sp/>flags,<sp/>which<sp/>may<sp/>be<sp/>mixed<sp/>with<sp/>&quot;-I..&quot;</highlight></codeline>
<codeline lineno="771"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Returns:</highlight></codeline>
<codeline lineno="772"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>A<sp/>tuple<sp/>of<sp/>lists:<sp/>(clean_clfags,<sp/>include_paths).<sp/>&quot;-I..&quot;<sp/>is<sp/>trimmed.</highlight></codeline>
<codeline lineno="773"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="774"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>clean_cflags<sp/>=<sp/>[]</highlight></codeline>
<codeline lineno="775"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>include_paths<sp/>=<sp/>[]</highlight></codeline>
<codeline lineno="776"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>flag<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>cflags:</highlight></codeline>
<codeline lineno="777"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>flag.startswith(</highlight><highlight class="stringliteral">&quot;-I&quot;</highlight><highlight class="normal">):</highlight></codeline>
<codeline lineno="778"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>include_paths.append(flag[2:])</highlight></codeline>
<codeline lineno="779"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="780"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>clean_cflags.append(flag)</highlight></codeline>
<codeline lineno="781"><highlight class="normal"></highlight></codeline>
<codeline lineno="782"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>(clean_cflags,<sp/>include_paths)</highlight></codeline>
<codeline lineno="783"><highlight class="normal"></highlight></codeline>
<codeline lineno="784" refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1a9789f27bcd0c4a0a3395047038bc2504" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1a9789f27bcd0c4a0a3395047038bc2504" kindref="member">FilterLibraries</ref>(self,<sp/>libraries):</highlight></codeline>
<codeline lineno="785"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Filter<sp/>the<sp/>&apos;libraries&apos;<sp/>key<sp/>to<sp/>separate<sp/>things<sp/>that<sp/>shouldn&apos;t<sp/>be<sp/>ldflags.</highlight></codeline>
<codeline lineno="786"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="787"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Library<sp/>entries<sp/>that<sp/>look<sp/>like<sp/>filenames<sp/>should<sp/>be<sp/>converted<sp/>to<sp/>android</highlight></codeline>
<codeline lineno="788"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>module<sp/>names<sp/>instead<sp/>of<sp/>being<sp/>passed<sp/>to<sp/>the<sp/>linker<sp/>as<sp/>flags.</highlight></codeline>
<codeline lineno="789"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="790"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Args:</highlight></codeline>
<codeline lineno="791"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>libraries:<sp/>the<sp/>value<sp/>of<sp/>spec.get(&apos;libraries&apos;)</highlight></codeline>
<codeline lineno="792"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Returns:</highlight></codeline>
<codeline lineno="793"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>A<sp/>tuple<sp/>(static_lib_modules,<sp/>dynamic_lib_modules,<sp/>ldflags)</highlight></codeline>
<codeline lineno="794"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="795"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>static_lib_modules<sp/>=<sp/>[]</highlight></codeline>
<codeline lineno="796"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dynamic_lib_modules<sp/>=<sp/>[]</highlight></codeline>
<codeline lineno="797"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ldflags<sp/>=<sp/>[]</highlight></codeline>
<codeline lineno="798"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>libs<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>libraries:</highlight></codeline>
<codeline lineno="799"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>Libs<sp/>can<sp/>have<sp/>multiple<sp/>words.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="800"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>lib<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>libs.split():</highlight></codeline>
<codeline lineno="801"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>Filter<sp/>the<sp/>system<sp/>libraries,<sp/>which<sp/>are<sp/>added<sp/>by<sp/>default<sp/>by<sp/>the<sp/>Android</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="802"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>build<sp/>system.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="803"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(</highlight></codeline>
<codeline lineno="804"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>lib<sp/>==<sp/></highlight><highlight class="stringliteral">&quot;-lc&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="805"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">or</highlight><highlight class="normal"><sp/>lib<sp/>==<sp/></highlight><highlight class="stringliteral">&quot;-lstdc++&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="806"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">or</highlight><highlight class="normal"><sp/>lib<sp/>==<sp/></highlight><highlight class="stringliteral">&quot;-lm&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="807"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">or</highlight><highlight class="normal"><sp/>lib.endswith(</highlight><highlight class="stringliteral">&quot;libgcc.a&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="808"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>):</highlight></codeline>
<codeline lineno="809"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="810"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>match<sp/>=<sp/>re.search(</highlight><highlight class="stringliteral">r&quot;([^/]+)\.a$&quot;</highlight><highlight class="normal">,<sp/>lib)</highlight></codeline>
<codeline lineno="811"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>match:</highlight></codeline>
<codeline lineno="812"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>static_lib_modules.append(match.group(1))</highlight></codeline>
<codeline lineno="813"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="814"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>match<sp/>=<sp/>re.search(</highlight><highlight class="stringliteral">r&quot;([^/]+)\.so$&quot;</highlight><highlight class="normal">,<sp/>lib)</highlight></codeline>
<codeline lineno="815"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>match:</highlight></codeline>
<codeline lineno="816"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dynamic_lib_modules.append(match.group(1))</highlight></codeline>
<codeline lineno="817"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="818"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>lib.startswith(</highlight><highlight class="stringliteral">&quot;-l&quot;</highlight><highlight class="normal">):</highlight></codeline>
<codeline lineno="819"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ldflags.append(lib)</highlight></codeline>
<codeline lineno="820"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>(static_lib_modules,<sp/>dynamic_lib_modules,<sp/>ldflags)</highlight></codeline>
<codeline lineno="821"><highlight class="normal"></highlight></codeline>
<codeline lineno="822" refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1a31e97f3ac28bc9e69e8b0cc194702673" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1a31e97f3ac28bc9e69e8b0cc194702673" kindref="member">ComputeDeps</ref>(self,<sp/>spec):</highlight></codeline>
<codeline lineno="823"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Compute<sp/>the<sp/>dependencies<sp/>of<sp/>a<sp/>gyp<sp/>spec.</highlight></codeline>
<codeline lineno="824"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="825"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Returns<sp/>a<sp/>tuple<sp/>(deps,<sp/>link_deps),<sp/>where<sp/>each<sp/>is<sp/>a<sp/>list<sp/>of</highlight></codeline>
<codeline lineno="826"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>filenames<sp/>that<sp/>will<sp/>need<sp/>to<sp/>be<sp/>put<sp/>in<sp/>front<sp/>of<sp/>make<sp/>for<sp/>either</highlight></codeline>
<codeline lineno="827"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>building<sp/>(deps)<sp/>or<sp/>linking<sp/>(link_deps).</highlight></codeline>
<codeline lineno="828"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="829"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>deps<sp/>=<sp/>[]</highlight></codeline>
<codeline lineno="830"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>link_deps<sp/>=<sp/>[]</highlight></codeline>
<codeline lineno="831"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&quot;dependencies&quot;</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>spec:</highlight></codeline>
<codeline lineno="832"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>deps.extend(</highlight></codeline>
<codeline lineno="833"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>[</highlight></codeline>
<codeline lineno="834"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>target_outputs[dep]</highlight></codeline>
<codeline lineno="835"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>dep<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>spec[</highlight><highlight class="stringliteral">&quot;dependencies&quot;</highlight><highlight class="normal">]</highlight></codeline>
<codeline lineno="836"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>target_outputs[dep]</highlight></codeline>
<codeline lineno="837"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>]</highlight></codeline>
<codeline lineno="838"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>)</highlight></codeline>
<codeline lineno="839"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>dep<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>spec[</highlight><highlight class="stringliteral">&quot;dependencies&quot;</highlight><highlight class="normal">]:</highlight></codeline>
<codeline lineno="840"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>dep<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>target_link_deps:</highlight></codeline>
<codeline lineno="841"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>link_deps.append(target_link_deps[dep])</highlight></codeline>
<codeline lineno="842"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>deps.extend(link_deps)</highlight></codeline>
<codeline lineno="843"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>(<ref refid="namespacegyp_1_1common_1ad189f1004790fca1b7cdfc7c01dde48f" kindref="member">gyp.common.uniquer</ref>(deps),<sp/><ref refid="namespacegyp_1_1common_1ad189f1004790fca1b7cdfc7c01dde48f" kindref="member">gyp.common.uniquer</ref>(link_deps))</highlight></codeline>
<codeline lineno="844"><highlight class="normal"></highlight></codeline>
<codeline lineno="845" refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1a0dedfc15c65c3754e0290e40c7559706" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1a0dedfc15c65c3754e0290e40c7559706" kindref="member">WriteTargetFlags</ref>(self,<sp/>spec,<sp/>configs,<sp/>link_deps):</highlight></codeline>
<codeline lineno="846"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Write<sp/>Makefile<sp/>code<sp/>to<sp/>specify<sp/>the<sp/>link<sp/>flags<sp/>and<sp/>library<sp/>dependencies.</highlight></codeline>
<codeline lineno="847"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="848"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>spec,<sp/>configs:<sp/>input<sp/>from<sp/>gyp.</highlight></codeline>
<codeline lineno="849"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>link_deps:<sp/>link<sp/>dependency<sp/>list;<sp/>see<sp/>ComputeDeps()</highlight></codeline>
<codeline lineno="850"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="851"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>Libraries<sp/>(i.e.<sp/>-lfoo)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="852"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>These<sp/>must<sp/>be<sp/>included<sp/>even<sp/>for<sp/>static<sp/>libraries<sp/>as<sp/>some<sp/>of<sp/>them<sp/>provide</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="853"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>implicit<sp/>include<sp/>paths<sp/>through<sp/>the<sp/>build<sp/>system.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="854"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>libraries<sp/>=<sp/><ref refid="namespacegyp_1_1common_1ad189f1004790fca1b7cdfc7c01dde48f" kindref="member">gyp.common.uniquer</ref>(spec.get(</highlight><highlight class="stringliteral">&quot;libraries&quot;</highlight><highlight class="normal">,<sp/>[]))</highlight></codeline>
<codeline lineno="855"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>static_libs,<sp/>dynamic_libs,<sp/>ldflags_libs<sp/>=<sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1a9789f27bcd0c4a0a3395047038bc2504" kindref="member">FilterLibraries</ref>(libraries)</highlight></codeline>
<codeline lineno="856"><highlight class="normal"></highlight></codeline>
<codeline lineno="857"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1a6d061a84eb6f6ab0d1dfeabd0ea61f04" kindref="member">type</ref><sp/>!=<sp/></highlight><highlight class="stringliteral">&quot;static_library&quot;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="858"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>configname,<sp/>config<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>sorted(configs.items()):</highlight></codeline>
<codeline lineno="859"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ldflags<sp/>=<sp/>list(config.get(</highlight><highlight class="stringliteral">&quot;ldflags&quot;</highlight><highlight class="normal">,<sp/>[]))</highlight></codeline>
<codeline lineno="860"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1ac4046b7ff870a361f075cda0e1f872d1" kindref="member">WriteLn</ref>(</highlight><highlight class="stringliteral">&quot;&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="861"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1a043072c186835f10859fccfc7409e708" kindref="member">WriteList</ref>(ldflags,<sp/></highlight><highlight class="stringliteral">&quot;LOCAL_LDFLAGS_%s&quot;</highlight><highlight class="normal"><sp/>%<sp/>configname)</highlight></codeline>
<codeline lineno="862"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1a043072c186835f10859fccfc7409e708" kindref="member">WriteList</ref>(ldflags_libs,<sp/></highlight><highlight class="stringliteral">&quot;LOCAL_GYP_LIBS&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="863"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1ac4046b7ff870a361f075cda0e1f872d1" kindref="member">WriteLn</ref>(</highlight></codeline>
<codeline lineno="864"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;LOCAL_LDFLAGS<sp/>:=<sp/>$(LOCAL_LDFLAGS_$(GYP_CONFIGURATION))<sp/>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="865"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;$(LOCAL_GYP_LIBS)&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="866"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>)</highlight></codeline>
<codeline lineno="867"><highlight class="normal"></highlight></codeline>
<codeline lineno="868"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>Link<sp/>dependencies<sp/>(i.e.<sp/>other<sp/>gyp<sp/>targets<sp/>this<sp/>target<sp/>depends<sp/>on)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="869"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>These<sp/>need<sp/>not<sp/>be<sp/>included<sp/>for<sp/>static<sp/>libraries<sp/>as<sp/>within<sp/>the<sp/>gyp<sp/>build</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="870"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>we<sp/>do<sp/>not<sp/>use<sp/>the<sp/>implicit<sp/>include<sp/>path<sp/>mechanism.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="871"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1a6d061a84eb6f6ab0d1dfeabd0ea61f04" kindref="member">type</ref><sp/>!=<sp/></highlight><highlight class="stringliteral">&quot;static_library&quot;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="872"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>static_link_deps<sp/>=<sp/>[x[1]<sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>x<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>link_deps<sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>x[0]<sp/>==<sp/></highlight><highlight class="stringliteral">&quot;static&quot;</highlight><highlight class="normal">]</highlight></codeline>
<codeline lineno="873"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>shared_link_deps<sp/>=<sp/>[x[1]<sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>x<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>link_deps<sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>x[0]<sp/>==<sp/></highlight><highlight class="stringliteral">&quot;shared&quot;</highlight><highlight class="normal">]</highlight></codeline>
<codeline lineno="874"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="875"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>static_link_deps<sp/>=<sp/>[]</highlight></codeline>
<codeline lineno="876"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>shared_link_deps<sp/>=<sp/>[]</highlight></codeline>
<codeline lineno="877"><highlight class="normal"></highlight></codeline>
<codeline lineno="878"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>Only<sp/>write<sp/>the<sp/>lists<sp/>if<sp/>they<sp/>are<sp/>non-empty.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="879"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>static_libs<sp/></highlight><highlight class="keywordflow">or</highlight><highlight class="normal"><sp/>static_link_deps:</highlight></codeline>
<codeline lineno="880"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1ac4046b7ff870a361f075cda0e1f872d1" kindref="member">WriteLn</ref>(</highlight><highlight class="stringliteral">&quot;&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="881"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1a043072c186835f10859fccfc7409e708" kindref="member">WriteList</ref>(static_libs<sp/>+<sp/>static_link_deps,<sp/></highlight><highlight class="stringliteral">&quot;LOCAL_STATIC_LIBRARIES&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="882"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1ac4046b7ff870a361f075cda0e1f872d1" kindref="member">WriteLn</ref>(</highlight><highlight class="stringliteral">&quot;#<sp/>Enable<sp/>grouping<sp/>to<sp/>fix<sp/>circular<sp/>references&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="883"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1ac4046b7ff870a361f075cda0e1f872d1" kindref="member">WriteLn</ref>(</highlight><highlight class="stringliteral">&quot;LOCAL_GROUP_STATIC_LIBRARIES<sp/>:=<sp/>true&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="884"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>dynamic_libs<sp/></highlight><highlight class="keywordflow">or</highlight><highlight class="normal"><sp/>shared_link_deps:</highlight></codeline>
<codeline lineno="885"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1ac4046b7ff870a361f075cda0e1f872d1" kindref="member">WriteLn</ref>(</highlight><highlight class="stringliteral">&quot;&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="886"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1a043072c186835f10859fccfc7409e708" kindref="member">WriteList</ref>(dynamic_libs<sp/>+<sp/>shared_link_deps,<sp/></highlight><highlight class="stringliteral">&quot;LOCAL_SHARED_LIBRARIES&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="887"><highlight class="normal"></highlight></codeline>
<codeline lineno="888" refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1a0203644abb72a4a0db1c51a3ed6a4892" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1a0203644abb72a4a0db1c51a3ed6a4892" kindref="member">WriteTarget</ref>(</highlight></codeline>
<codeline lineno="889"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self,<sp/>spec,<sp/>configs,<sp/>deps,<sp/>link_deps,<sp/>part_of_all,<sp/>write_alias_target</highlight></codeline>
<codeline lineno="890"><highlight class="normal"><sp/><sp/><sp/><sp/>):</highlight></codeline>
<codeline lineno="891"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Write<sp/>Makefile<sp/>code<sp/>to<sp/>produce<sp/>the<sp/>final<sp/>target<sp/>of<sp/>the<sp/>gyp<sp/>spec.</highlight></codeline>
<codeline lineno="892"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="893"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>spec,<sp/>configs:<sp/>input<sp/>from<sp/>gyp.</highlight></codeline>
<codeline lineno="894"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>deps,<sp/>link_deps:<sp/>dependency<sp/>lists;<sp/>see<sp/>ComputeDeps()</highlight></codeline>
<codeline lineno="895"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>part_of_all:<sp/>flag<sp/>indicating<sp/>this<sp/>target<sp/>is<sp/>part<sp/>of<sp/>&apos;all&apos;</highlight></codeline>
<codeline lineno="896"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>write_alias_target:<sp/>flag<sp/>indicating<sp/>whether<sp/>to<sp/>create<sp/>short<sp/>aliases<sp/>for<sp/>this</highlight></codeline>
<codeline lineno="897"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>target</highlight></codeline>
<codeline lineno="898"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="899"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1ac4046b7ff870a361f075cda0e1f872d1" kindref="member">WriteLn</ref>(</highlight><highlight class="stringliteral">&quot;###<sp/>Rules<sp/>for<sp/>final<sp/>target.&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="900"><highlight class="normal"></highlight></codeline>
<codeline lineno="901"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1a6d061a84eb6f6ab0d1dfeabd0ea61f04" kindref="member">type</ref><sp/>!=<sp/></highlight><highlight class="stringliteral">&quot;none&quot;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="902"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1a0dedfc15c65c3754e0290e40c7559706" kindref="member">WriteTargetFlags</ref>(spec,<sp/>configs,<sp/>link_deps)</highlight></codeline>
<codeline lineno="903"><highlight class="normal"></highlight></codeline>
<codeline lineno="904"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>settings<sp/>=<sp/>spec.get(</highlight><highlight class="stringliteral">&quot;aosp_build_settings&quot;</highlight><highlight class="normal">,<sp/>{})</highlight></codeline>
<codeline lineno="905"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>settings:</highlight></codeline>
<codeline lineno="906"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1ac4046b7ff870a361f075cda0e1f872d1" kindref="member">WriteLn</ref>(</highlight><highlight class="stringliteral">&quot;###<sp/>Set<sp/>directly<sp/>by<sp/>aosp_build_settings.&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="907"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>k,<sp/>v<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>settings.items():</highlight></codeline>
<codeline lineno="908"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>isinstance(v,<sp/>list):</highlight></codeline>
<codeline lineno="909"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1a043072c186835f10859fccfc7409e708" kindref="member">WriteList</ref>(v,<sp/>k)</highlight></codeline>
<codeline lineno="910"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="911"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1ac4046b7ff870a361f075cda0e1f872d1" kindref="member">WriteLn</ref>(f</highlight><highlight class="stringliteral">&quot;{k}<sp/>:=<sp/>{make.QuoteIfNecessary(v)}&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="912"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1ac4046b7ff870a361f075cda0e1f872d1" kindref="member">WriteLn</ref>(</highlight><highlight class="stringliteral">&quot;&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="913"><highlight class="normal"></highlight></codeline>
<codeline lineno="914"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>Add<sp/>to<sp/>the<sp/>set<sp/>of<sp/>targets<sp/>which<sp/>represent<sp/>the<sp/>gyp<sp/>&apos;all&apos;<sp/>target.<sp/>We<sp/>use<sp/>the</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="915"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>name<sp/>&apos;gyp_all_modules&apos;<sp/>as<sp/>the<sp/>Android<sp/>build<sp/>system<sp/>doesn&apos;t<sp/>allow<sp/>the<sp/>use</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="916"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>of<sp/>the<sp/>Make<sp/>target<sp/>&apos;all&apos;<sp/>and<sp/>because<sp/>&apos;all_modules&apos;<sp/>is<sp/>the<sp/>equivalent<sp/>of</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="917"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>the<sp/>Make<sp/>target<sp/>&apos;all&apos;<sp/>on<sp/>Android.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="918"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>part_of_all<sp/></highlight><highlight class="keywordflow">and</highlight><highlight class="normal"><sp/>write_alias_target:</highlight></codeline>
<codeline lineno="919"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1ac4046b7ff870a361f075cda0e1f872d1" kindref="member">WriteLn</ref>(</highlight><highlight class="stringliteral">&apos;#<sp/>Add<sp/>target<sp/>alias<sp/>to<sp/>&quot;gyp_all_modules&quot;<sp/>target.&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="920"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1ac4046b7ff870a361f075cda0e1f872d1" kindref="member">WriteLn</ref>(</highlight><highlight class="stringliteral">&quot;.PHONY:<sp/>gyp_all_modules&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="921"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1ac4046b7ff870a361f075cda0e1f872d1" kindref="member">WriteLn</ref>(</highlight><highlight class="stringliteral">&quot;gyp_all_modules:<sp/>%s&quot;</highlight><highlight class="normal"><sp/>%<sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1abfa6ab16aba8a08680d3397d4f55761f" kindref="member">android_module</ref>)</highlight></codeline>
<codeline lineno="922"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1ac4046b7ff870a361f075cda0e1f872d1" kindref="member">WriteLn</ref>(</highlight><highlight class="stringliteral">&quot;&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="923"><highlight class="normal"></highlight></codeline>
<codeline lineno="924"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>Add<sp/>an<sp/>alias<sp/>from<sp/>the<sp/>gyp<sp/>target<sp/>name<sp/>to<sp/>the<sp/>Android<sp/>module<sp/>name.<sp/>This</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="925"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>simplifies<sp/>manual<sp/>builds<sp/>of<sp/>the<sp/>target,<sp/>and<sp/>is<sp/>required<sp/>by<sp/>the<sp/>test</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="926"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>framework.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="927"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1a5e68bf68b8950fe2ac3038c730477682" kindref="member">target</ref><sp/>!=<sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1abfa6ab16aba8a08680d3397d4f55761f" kindref="member">android_module</ref><sp/></highlight><highlight class="keywordflow">and</highlight><highlight class="normal"><sp/>write_alias_target:</highlight></codeline>
<codeline lineno="928"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1ac4046b7ff870a361f075cda0e1f872d1" kindref="member">WriteLn</ref>(</highlight><highlight class="stringliteral">&quot;#<sp/>Alias<sp/>gyp<sp/>target<sp/>name.&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="929"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1ac4046b7ff870a361f075cda0e1f872d1" kindref="member">WriteLn</ref>(</highlight><highlight class="stringliteral">&quot;.PHONY:<sp/>%s&quot;</highlight><highlight class="normal"><sp/>%<sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1a5e68bf68b8950fe2ac3038c730477682" kindref="member">target</ref>)</highlight></codeline>
<codeline lineno="930"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1ac4046b7ff870a361f075cda0e1f872d1" kindref="member">WriteLn</ref>(f</highlight><highlight class="stringliteral">&quot;{self.target}:<sp/>{self.android_module}&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="931"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1ac4046b7ff870a361f075cda0e1f872d1" kindref="member">WriteLn</ref>(</highlight><highlight class="stringliteral">&quot;&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="932"><highlight class="normal"></highlight></codeline>
<codeline lineno="933"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>Add<sp/>the<sp/>command<sp/>to<sp/>trigger<sp/>build<sp/>of<sp/>the<sp/>target<sp/>type<sp/>depending</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="934"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>on<sp/>the<sp/>toolset.<sp/>Ex:<sp/>BUILD_STATIC_LIBRARY<sp/>vs.<sp/>BUILD_HOST_STATIC_LIBRARY</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="935"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>NOTE:<sp/>This<sp/>has<sp/>to<sp/>come<sp/>last!</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="936"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>modifier<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="937"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1aac067c5ee71afa848000a1f5e0138be1" kindref="member">toolset</ref><sp/>==<sp/></highlight><highlight class="stringliteral">&quot;host&quot;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="938"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>modifier<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;HOST_&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="939"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1a6d061a84eb6f6ab0d1dfeabd0ea61f04" kindref="member">type</ref><sp/>==<sp/></highlight><highlight class="stringliteral">&quot;static_library&quot;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="940"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1ac4046b7ff870a361f075cda0e1f872d1" kindref="member">WriteLn</ref>(</highlight><highlight class="stringliteral">&quot;include<sp/>$(BUILD_%sSTATIC_LIBRARY)&quot;</highlight><highlight class="normal"><sp/>%<sp/>modifier)</highlight></codeline>
<codeline lineno="941"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1a6d061a84eb6f6ab0d1dfeabd0ea61f04" kindref="member">type</ref><sp/>==<sp/></highlight><highlight class="stringliteral">&quot;shared_library&quot;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="942"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1ac4046b7ff870a361f075cda0e1f872d1" kindref="member">WriteLn</ref>(</highlight><highlight class="stringliteral">&quot;LOCAL_PRELINK_MODULE<sp/>:=<sp/>false&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="943"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1ac4046b7ff870a361f075cda0e1f872d1" kindref="member">WriteLn</ref>(</highlight><highlight class="stringliteral">&quot;include<sp/>$(BUILD_%sSHARED_LIBRARY)&quot;</highlight><highlight class="normal"><sp/>%<sp/>modifier)</highlight></codeline>
<codeline lineno="944"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1a6d061a84eb6f6ab0d1dfeabd0ea61f04" kindref="member">type</ref><sp/>==<sp/></highlight><highlight class="stringliteral">&quot;executable&quot;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="945"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1ac4046b7ff870a361f075cda0e1f872d1" kindref="member">WriteLn</ref>(</highlight><highlight class="stringliteral">&quot;LOCAL_CXX_STL<sp/>:=<sp/>libc++_static&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="946"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>Executables<sp/>are<sp/>for<sp/>build<sp/>and<sp/>test<sp/>purposes<sp/>only,<sp/>so<sp/>they&apos;re<sp/>installed</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="947"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>to<sp/>a<sp/>directory<sp/>that<sp/>doesn&apos;t<sp/>get<sp/>included<sp/>in<sp/>the<sp/>system<sp/>image.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="948"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1ac4046b7ff870a361f075cda0e1f872d1" kindref="member">WriteLn</ref>(</highlight><highlight class="stringliteral">&quot;LOCAL_MODULE_PATH<sp/>:=<sp/>$(gyp_shared_intermediate_dir)&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="949"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1ac4046b7ff870a361f075cda0e1f872d1" kindref="member">WriteLn</ref>(</highlight><highlight class="stringliteral">&quot;include<sp/>$(BUILD_%sEXECUTABLE)&quot;</highlight><highlight class="normal"><sp/>%<sp/>modifier)</highlight></codeline>
<codeline lineno="950"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="951"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1ac4046b7ff870a361f075cda0e1f872d1" kindref="member">WriteLn</ref>(</highlight><highlight class="stringliteral">&quot;LOCAL_MODULE_PATH<sp/>:=<sp/>$(PRODUCT_OUT)/gyp_stamp&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="952"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1ac4046b7ff870a361f075cda0e1f872d1" kindref="member">WriteLn</ref>(</highlight><highlight class="stringliteral">&quot;LOCAL_UNINSTALLABLE_MODULE<sp/>:=<sp/>true&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="953"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1aac067c5ee71afa848000a1f5e0138be1" kindref="member">toolset</ref><sp/>==<sp/></highlight><highlight class="stringliteral">&quot;target&quot;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="954"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1ac4046b7ff870a361f075cda0e1f872d1" kindref="member">WriteLn</ref>(</highlight><highlight class="stringliteral">&quot;LOCAL_2ND_ARCH_VAR_PREFIX<sp/>:=<sp/>$(GYP_VAR_PREFIX)&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="955"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="956"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1ac4046b7ff870a361f075cda0e1f872d1" kindref="member">WriteLn</ref>(</highlight><highlight class="stringliteral">&quot;LOCAL_2ND_ARCH_VAR_PREFIX<sp/>:=<sp/>$(GYP_HOST_VAR_PREFIX)&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="957"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1ac4046b7ff870a361f075cda0e1f872d1" kindref="member">WriteLn</ref>()</highlight></codeline>
<codeline lineno="958"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1ac4046b7ff870a361f075cda0e1f872d1" kindref="member">WriteLn</ref>(</highlight><highlight class="stringliteral">&quot;include<sp/>$(BUILD_SYSTEM)/base_rules.mk&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="959"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1ac4046b7ff870a361f075cda0e1f872d1" kindref="member">WriteLn</ref>()</highlight></codeline>
<codeline lineno="960"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1ac4046b7ff870a361f075cda0e1f872d1" kindref="member">WriteLn</ref>(</highlight><highlight class="stringliteral">&quot;$(LOCAL_BUILT_MODULE):<sp/>$(LOCAL_ADDITIONAL_DEPENDENCIES)&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="961"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1ac4046b7ff870a361f075cda0e1f872d1" kindref="member">WriteLn</ref>(</highlight><highlight class="stringliteral">&apos;\t$(hide)<sp/>echo<sp/>&quot;Gyp<sp/>timestamp:<sp/>$@&quot;&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="962"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1ac4046b7ff870a361f075cda0e1f872d1" kindref="member">WriteLn</ref>(</highlight><highlight class="stringliteral">&quot;\t$(hide)<sp/>mkdir<sp/>-p<sp/>$(dir<sp/>$@)&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="963"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1ac4046b7ff870a361f075cda0e1f872d1" kindref="member">WriteLn</ref>(</highlight><highlight class="stringliteral">&quot;\t$(hide)<sp/>touch<sp/>$@&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="964"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1ac4046b7ff870a361f075cda0e1f872d1" kindref="member">WriteLn</ref>()</highlight></codeline>
<codeline lineno="965"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1ac4046b7ff870a361f075cda0e1f872d1" kindref="member">WriteLn</ref>(</highlight><highlight class="stringliteral">&quot;LOCAL_2ND_ARCH_VAR_PREFIX<sp/>:=&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="966"><highlight class="normal"></highlight></codeline>
<codeline lineno="967" refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1a043072c186835f10859fccfc7409e708" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1a043072c186835f10859fccfc7409e708" kindref="member">WriteList</ref>(</highlight></codeline>
<codeline lineno="968"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self,</highlight></codeline>
<codeline lineno="969"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>value_list,</highlight></codeline>
<codeline lineno="970"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>variable=None,</highlight></codeline>
<codeline lineno="971"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>prefix=&quot;&quot;,</highlight></codeline>
<codeline lineno="972"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>quoter=make.QuoteIfNecessary,</highlight></codeline>
<codeline lineno="973"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>local_pathify=False,</highlight></codeline>
<codeline lineno="974"><highlight class="normal"><sp/><sp/><sp/><sp/>):</highlight></codeline>
<codeline lineno="975"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Write<sp/>a<sp/>variable<sp/>definition<sp/>that<sp/>is<sp/>a<sp/>list<sp/>of<sp/>values.</highlight></codeline>
<codeline lineno="976"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="977"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>E.g.<sp/>WriteList([&apos;a&apos;,&apos;b&apos;],<sp/>&apos;foo&apos;,<sp/>prefix=&apos;blah&apos;)<sp/>writes<sp/>out</highlight></codeline>
<codeline lineno="978"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>foo<sp/>=<sp/>blaha<sp/>blahb</highlight></codeline>
<codeline lineno="979"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>but<sp/>in<sp/>a<sp/>pretty-printed<sp/>style.</highlight></codeline>
<codeline lineno="980"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="981"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>values<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="982"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>value_list:</highlight></codeline>
<codeline lineno="983"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>value_list<sp/>=<sp/>[quoter(prefix<sp/>+<sp/>value)<sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>value<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>value_list]</highlight></codeline>
<codeline lineno="984"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>local_pathify:</highlight></codeline>
<codeline lineno="985"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>value_list<sp/>=<sp/>[self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1a172c16217eab4fca1017c7d4fabcbf1d" kindref="member">LocalPathify</ref><ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1aadd56929484e5da3d614414dbb9bcd30" kindref="member">LocalPathify</ref>(value)<sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>value<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>value_list]</highlight></codeline>
<codeline lineno="986"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>values<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;<sp/>\\\n\t&quot;</highlight><highlight class="normal"><sp/>+<sp/></highlight><highlight class="stringliteral">&quot;<sp/>\\\n\t&quot;</highlight><highlight class="normal">.join(value_list)</highlight></codeline>
<codeline lineno="987"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1a797b61134908691a06ff70c9899e9a6e" kindref="member">fp</ref>.write(f</highlight><highlight class="stringliteral">&quot;{variable}<sp/>:={values}\n\n&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="988"><highlight class="normal"></highlight></codeline>
<codeline lineno="989" refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1ac4046b7ff870a361f075cda0e1f872d1" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1ac4046b7ff870a361f075cda0e1f872d1" kindref="member">WriteLn</ref>(self,<sp/>text=&quot;&quot;):</highlight></codeline>
<codeline lineno="990"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1a797b61134908691a06ff70c9899e9a6e" kindref="member">fp</ref>.write(text<sp/>+<sp/></highlight><highlight class="stringliteral">&quot;\n&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="991"><highlight class="normal"></highlight></codeline>
<codeline lineno="992" refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1aadd56929484e5da3d614414dbb9bcd30" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1a172c16217eab4fca1017c7d4fabcbf1d" kindref="member">LocalPathify</ref>(self,<sp/>path):</highlight></codeline>
<codeline lineno="993"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Convert<sp/>a<sp/>subdirectory-relative<sp/>path<sp/>into<sp/>a<sp/>normalized<sp/>path<sp/>which<sp/>starts</highlight></codeline>
<codeline lineno="994"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>with<sp/>the<sp/>make<sp/>variable<sp/>$(LOCAL_PATH)<sp/>(i.e.<sp/>the<sp/>top<sp/>of<sp/>the<sp/>project<sp/>tree).</highlight></codeline>
<codeline lineno="995"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Absolute<sp/>paths,<sp/>or<sp/>paths<sp/>that<sp/>contain<sp/>variables,<sp/>are<sp/>just<sp/>normalized.&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="996"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&quot;$(&quot;</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>path<sp/></highlight><highlight class="keywordflow">or</highlight><highlight class="normal"><sp/>os.path.isabs(path):</highlight></codeline>
<codeline lineno="997"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>path<sp/>is<sp/>not<sp/>a<sp/>file<sp/>in<sp/>the<sp/>project<sp/>tree<sp/>in<sp/>this<sp/>case,<sp/>but<sp/>calling</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="998"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>normpath<sp/>is<sp/>still<sp/>important<sp/>for<sp/>trimming<sp/>trailing<sp/>slashes.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="999"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>os.path.normpath(path)</highlight></codeline>
<codeline lineno="1000"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>local_path<sp/>=<sp/>os.path.join(</highlight><highlight class="stringliteral">&quot;$(LOCAL_PATH)&quot;</highlight><highlight class="normal">,<sp/>self.<ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1aa40cc309d9d8adc770d83510757dc0cb" kindref="member">path</ref>,<sp/>path)</highlight></codeline>
<codeline lineno="1001"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>local_path<sp/>=<sp/>os.path.normpath(local_path)</highlight></codeline>
<codeline lineno="1002"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>Check<sp/>that<sp/>normalizing<sp/>the<sp/>path<sp/>didn&apos;t<sp/>../<sp/>itself<sp/>out<sp/>of<sp/>$(LOCAL_PATH)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1003"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>-<sp/>i.e.<sp/>that<sp/>the<sp/>resulting<sp/>path<sp/>is<sp/>still<sp/>inside<sp/>the<sp/>project<sp/>tree.<sp/>The</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1004"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>path<sp/>may<sp/>legitimately<sp/>have<sp/>ended<sp/>up<sp/>containing<sp/>just<sp/>$(LOCAL_PATH),<sp/>though,</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1005"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>so<sp/>we<sp/>don&apos;t<sp/>look<sp/>for<sp/>a<sp/>slash.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1006"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">assert</highlight><highlight class="normal"><sp/>local_path.startswith(</highlight></codeline>
<codeline lineno="1007"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;$(LOCAL_PATH)&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1008"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>),<sp/>f</highlight><highlight class="stringliteral">&quot;Path<sp/>{path}<sp/>attempts<sp/>to<sp/>escape<sp/>from<sp/>gyp<sp/>path<sp/>{self.path}<sp/>!)&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1009"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>local_path</highlight></codeline>
<codeline lineno="1010"><highlight class="normal"></highlight></codeline>
<codeline lineno="1011" refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1a095f55ed01efb9380c770c0f6f703f4d" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer_1a095f55ed01efb9380c770c0f6f703f4d" kindref="member">ExpandInputRoot</ref>(self,<sp/>template,<sp/>expansion,<sp/>dirname):</highlight></codeline>
<codeline lineno="1012"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&quot;%(INPUT_ROOT)s&quot;</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>template<sp/></highlight><highlight class="keywordflow">and</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&quot;%(INPUT_DIRNAME)s&quot;</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>template:</highlight></codeline>
<codeline lineno="1013"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>template</highlight></codeline>
<codeline lineno="1014"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>path<sp/>=<sp/>template<sp/>%<sp/>{</highlight></codeline>
<codeline lineno="1015"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;INPUT_ROOT&quot;</highlight><highlight class="normal">:<sp/>expansion,</highlight></codeline>
<codeline lineno="1016"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;INPUT_DIRNAME&quot;</highlight><highlight class="normal">:<sp/>dirname,</highlight></codeline>
<codeline lineno="1017"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1018"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>os.path.normpath(path)</highlight></codeline>
<codeline lineno="1019"><highlight class="normal"></highlight></codeline>
<codeline lineno="1020"><highlight class="normal"></highlight></codeline>
<codeline lineno="1021" refid="namespacegyp_1_1generator_1_1android_1acb3c2277d54d5c804786583f2c5c7c54" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="namespacegyp_1_1generator_1_1android_1acb3c2277d54d5c804786583f2c5c7c54" kindref="member">PerformBuild</ref>(data,<sp/>configurations,<sp/>params):</highlight></codeline>
<codeline lineno="1022"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>The<sp/>android<sp/>backend<sp/>only<sp/>supports<sp/>the<sp/>default<sp/>configuration.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1023"><highlight class="normal"><sp/><sp/><sp/><sp/>options<sp/>=<sp/>params[</highlight><highlight class="stringliteral">&quot;options&quot;</highlight><highlight class="normal">]</highlight></codeline>
<codeline lineno="1024"><highlight class="normal"><sp/><sp/><sp/><sp/>makefile<sp/>=<sp/>os.path.abspath(os.path.join(options.toplevel_dir,<sp/></highlight><highlight class="stringliteral">&quot;GypAndroid.mk&quot;</highlight><highlight class="normal">))</highlight></codeline>
<codeline lineno="1025"><highlight class="normal"><sp/><sp/><sp/><sp/>env<sp/>=<sp/>dict(os.environ)</highlight></codeline>
<codeline lineno="1026"><highlight class="normal"><sp/><sp/><sp/><sp/>env[</highlight><highlight class="stringliteral">&quot;ONE_SHOT_MAKEFILE&quot;</highlight><highlight class="normal">]<sp/>=<sp/>makefile</highlight></codeline>
<codeline lineno="1027"><highlight class="normal"><sp/><sp/><sp/><sp/>arguments<sp/>=<sp/>[</highlight><highlight class="stringliteral">&quot;make&quot;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&quot;-C&quot;</highlight><highlight class="normal">,<sp/>os.environ[</highlight><highlight class="stringliteral">&quot;ANDROID_BUILD_TOP&quot;</highlight><highlight class="normal">],<sp/></highlight><highlight class="stringliteral">&quot;gyp_all_modules&quot;</highlight><highlight class="normal">]</highlight></codeline>
<codeline lineno="1028"><highlight class="normal"><sp/><sp/><sp/><sp/>print(</highlight><highlight class="stringliteral">&quot;Building:<sp/>%s&quot;</highlight><highlight class="normal"><sp/>%<sp/>arguments)</highlight></codeline>
<codeline lineno="1029"><highlight class="normal"><sp/><sp/><sp/><sp/>subprocess.check_call(arguments,<sp/>env=env)</highlight></codeline>
<codeline lineno="1030"><highlight class="normal"></highlight></codeline>
<codeline lineno="1031"><highlight class="normal"></highlight></codeline>
<codeline lineno="1032" refid="namespacegyp_1_1generator_1_1android_1a3321c09c0805323dff9201c1c5968c57" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="namespacegyp_1_1generator_1_1android_1a3321c09c0805323dff9201c1c5968c57" kindref="member">GenerateOutput</ref>(target_list,<sp/>target_dicts,<sp/>data,<sp/>params):</highlight></codeline>
<codeline lineno="1033"><highlight class="normal"><sp/><sp/><sp/><sp/>options<sp/>=<sp/>params[</highlight><highlight class="stringliteral">&quot;options&quot;</highlight><highlight class="normal">]</highlight></codeline>
<codeline lineno="1034"><highlight class="normal"><sp/><sp/><sp/><sp/>generator_flags<sp/>=<sp/>params.get(</highlight><highlight class="stringliteral">&quot;generator_flags&quot;</highlight><highlight class="normal">,<sp/>{})</highlight></codeline>
<codeline lineno="1035"><highlight class="normal"><sp/><sp/><sp/><sp/>limit_to_target_all<sp/>=<sp/>generator_flags.get(</highlight><highlight class="stringliteral">&quot;limit_to_target_all&quot;</highlight><highlight class="normal">,<sp/></highlight><highlight class="keyword">False</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1036"><highlight class="normal"><sp/><sp/><sp/><sp/>write_alias_targets<sp/>=<sp/>generator_flags.get(</highlight><highlight class="stringliteral">&quot;write_alias_targets&quot;</highlight><highlight class="normal">,<sp/></highlight><highlight class="keyword">True</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1037"><highlight class="normal"><sp/><sp/><sp/><sp/>sdk_version<sp/>=<sp/>generator_flags.get(</highlight><highlight class="stringliteral">&quot;aosp_sdk_version&quot;</highlight><highlight class="normal">,<sp/>0)</highlight></codeline>
<codeline lineno="1038"><highlight class="normal"><sp/><sp/><sp/><sp/>android_top_dir<sp/>=<sp/>os.environ.get(</highlight><highlight class="stringliteral">&quot;ANDROID_BUILD_TOP&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1039"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">assert</highlight><highlight class="normal"><sp/>android_top_dir,<sp/></highlight><highlight class="stringliteral">&quot;$ANDROID_BUILD_TOP<sp/>not<sp/>set;<sp/>you<sp/>need<sp/>to<sp/>run<sp/>lunch.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1040"><highlight class="normal"></highlight></codeline>
<codeline lineno="1041"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal">CalculateMakefilePath(build_file,<sp/>base_name):</highlight></codeline>
<codeline lineno="1042"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Determine<sp/>where<sp/>to<sp/>write<sp/>a<sp/>Makefile<sp/>for<sp/>a<sp/>given<sp/>gyp<sp/>file.&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1043"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>Paths<sp/>in<sp/>gyp<sp/>files<sp/>are<sp/>relative<sp/>to<sp/>the<sp/>.gyp<sp/>file,<sp/>but<sp/>we<sp/>want</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1044"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>paths<sp/>relative<sp/>to<sp/>the<sp/>source<sp/>root<sp/>for<sp/>the<sp/>master<sp/>makefile.<sp/><sp/>Grab</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1045"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>the<sp/>path<sp/>of<sp/>the<sp/>.gyp<sp/>file<sp/>as<sp/>the<sp/>base<sp/>to<sp/>relativize<sp/>against.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1046"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>E.g.<sp/>&quot;foo/bar&quot;<sp/>when<sp/>we&apos;re<sp/>constructing<sp/>targets<sp/>for<sp/>&quot;foo/bar/baz.gyp&quot;.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1047"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>base_path<sp/>=<sp/><ref refid="namespacegyp_1_1common_1a8533ebdd9774c22ee7f7450c54239796" kindref="member">gyp.common.RelativePath</ref>(os.path.dirname(build_file),<sp/>options.depth)</highlight></codeline>
<codeline lineno="1048"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>We<sp/>write<sp/>the<sp/>file<sp/>in<sp/>the<sp/>base_path<sp/>directory.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1049"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>output_file<sp/>=<sp/>os.path.join(options.depth,<sp/>base_path,<sp/>base_name)</highlight></codeline>
<codeline lineno="1050"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">assert</highlight><highlight class="normal"><sp/>(</highlight></codeline>
<codeline lineno="1051"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>options.generator_output</highlight></codeline>
<codeline lineno="1052"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>),<sp/></highlight><highlight class="stringliteral">&quot;The<sp/>Android<sp/>backend<sp/>does<sp/>not<sp/>support<sp/>options.generator_output.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1053"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>base_path<sp/>=<sp/><ref refid="namespacegyp_1_1common_1a8533ebdd9774c22ee7f7450c54239796" kindref="member">gyp.common.RelativePath</ref>(</highlight></codeline>
<codeline lineno="1054"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>os.path.dirname(build_file),<sp/>options.toplevel_dir</highlight></codeline>
<codeline lineno="1055"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>)</highlight></codeline>
<codeline lineno="1056"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>base_path,<sp/>output_file</highlight></codeline>
<codeline lineno="1057"><highlight class="normal"></highlight></codeline>
<codeline lineno="1058"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>TODO:<sp/><sp/>search<sp/>for<sp/>the<sp/>first<sp/>non-&apos;Default&apos;<sp/>target.<sp/><sp/>This<sp/>can<sp/>go</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1059"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>away<sp/>when<sp/>we<sp/>add<sp/>verification<sp/>that<sp/>all<sp/>targets<sp/>have<sp/>the</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1060"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>necessary<sp/>configurations.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1061"><highlight class="normal"><sp/><sp/><sp/><sp/>default_configuration<sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1062"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>target<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>target_list:</highlight></codeline>
<codeline lineno="1063"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>spec<sp/>=<sp/>target_dicts[target]</highlight></codeline>
<codeline lineno="1064"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>spec[</highlight><highlight class="stringliteral">&quot;default_configuration&quot;</highlight><highlight class="normal">]<sp/>!=<sp/></highlight><highlight class="stringliteral">&quot;Default&quot;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="1065"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>default_configuration<sp/>=<sp/>spec[</highlight><highlight class="stringliteral">&quot;default_configuration&quot;</highlight><highlight class="normal">]</highlight></codeline>
<codeline lineno="1066"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1067"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>default_configuration:</highlight></codeline>
<codeline lineno="1068"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>default_configuration<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;Default&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1069"><highlight class="normal"></highlight></codeline>
<codeline lineno="1070"><highlight class="normal"><sp/><sp/><sp/><sp/>makefile_name<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;GypAndroid&quot;</highlight><highlight class="normal"><sp/>+<sp/>options.suffix<sp/>+<sp/></highlight><highlight class="stringliteral">&quot;.mk&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1071"><highlight class="normal"><sp/><sp/><sp/><sp/>makefile_path<sp/>=<sp/>os.path.join(options.toplevel_dir,<sp/>makefile_name)</highlight></codeline>
<codeline lineno="1072"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">assert</highlight><highlight class="normal"><sp/>(</highlight></codeline>
<codeline lineno="1073"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>options.generator_output</highlight></codeline>
<codeline lineno="1074"><highlight class="normal"><sp/><sp/><sp/><sp/>),<sp/></highlight><highlight class="stringliteral">&quot;The<sp/>Android<sp/>backend<sp/>does<sp/>not<sp/>support<sp/>options.generator_output.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1075"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="namespacegyp_1_1common_1a62411b7ed9f7220bb951ea26e91e4e15" kindref="member">gyp.common.EnsureDirExists</ref>(makefile_path)</highlight></codeline>
<codeline lineno="1076"><highlight class="normal"><sp/><sp/><sp/><sp/>root_makefile<sp/>=<sp/>open(makefile_path,<sp/></highlight><highlight class="stringliteral">&quot;w&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1077"><highlight class="normal"></highlight></codeline>
<codeline lineno="1078"><highlight class="normal"><sp/><sp/><sp/><sp/>root_makefile.write(header)</highlight></codeline>
<codeline lineno="1079"><highlight class="normal"></highlight></codeline>
<codeline lineno="1080"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>We<sp/>set<sp/>LOCAL_PATH<sp/>just<sp/>once,<sp/>here,<sp/>to<sp/>the<sp/>top<sp/>of<sp/>the<sp/>project<sp/>tree.<sp/>This</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1081"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>allows<sp/>all<sp/>the<sp/>other<sp/>paths<sp/>we<sp/>use<sp/>to<sp/>be<sp/>relative<sp/>to<sp/>the<sp/>Android.mk<sp/>file,</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1082"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>as<sp/>the<sp/>Android<sp/>build<sp/>system<sp/>expects.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1083"><highlight class="normal"><sp/><sp/><sp/><sp/>root_makefile.write(</highlight><highlight class="stringliteral">&quot;\nLOCAL_PATH<sp/>:=<sp/>$(call<sp/>my-dir)\n&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1084"><highlight class="normal"></highlight></codeline>
<codeline lineno="1085"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>Find<sp/>the<sp/>list<sp/>of<sp/>targets<sp/>that<sp/>derive<sp/>from<sp/>the<sp/>gyp<sp/>file(s)<sp/>being<sp/>built.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1086"><highlight class="normal"><sp/><sp/><sp/><sp/>needed_targets<sp/>=<sp/>set()</highlight></codeline>
<codeline lineno="1087"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>build_file<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>params[</highlight><highlight class="stringliteral">&quot;build_files&quot;</highlight><highlight class="normal">]:</highlight></codeline>
<codeline lineno="1088"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>target<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/><ref refid="namespacegyp_1_1common_1ae29bb9a2368860059458248dd76adeaa" kindref="member">gyp.common.AllTargets</ref>(target_list,<sp/>target_dicts,<sp/>build_file):</highlight></codeline>
<codeline lineno="1089"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>needed_targets.add(target)</highlight></codeline>
<codeline lineno="1090"><highlight class="normal"></highlight></codeline>
<codeline lineno="1091"><highlight class="normal"><sp/><sp/><sp/><sp/>build_files<sp/>=<sp/>set()</highlight></codeline>
<codeline lineno="1092"><highlight class="normal"><sp/><sp/><sp/><sp/>include_list<sp/>=<sp/>set()</highlight></codeline>
<codeline lineno="1093"><highlight class="normal"><sp/><sp/><sp/><sp/>android_modules<sp/>=<sp/>{}</highlight></codeline>
<codeline lineno="1094"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>qualified_target<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>target_list:</highlight></codeline>
<codeline lineno="1095"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>build_file,<sp/>target,<sp/>toolset<sp/>=<sp/><ref refid="namespacegyp_1_1common_1a51180f038e57ff79c30f6231d1d7958f" kindref="member">gyp.common.ParseQualifiedTarget</ref>(qualified_target)</highlight></codeline>
<codeline lineno="1096"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>relative_build_file<sp/>=<sp/><ref refid="namespacegyp_1_1common_1a8533ebdd9774c22ee7f7450c54239796" kindref="member">gyp.common.RelativePath</ref>(build_file,<sp/>options.toplevel_dir)</highlight></codeline>
<codeline lineno="1097"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>build_files.add(relative_build_file)</highlight></codeline>
<codeline lineno="1098"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>included_files<sp/>=<sp/>data[build_file][</highlight><highlight class="stringliteral">&quot;included_files&quot;</highlight><highlight class="normal">]</highlight></codeline>
<codeline lineno="1099"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>included_file<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>included_files:</highlight></codeline>
<codeline lineno="1100"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>The<sp/>included_files<sp/>entries<sp/>are<sp/>relative<sp/>to<sp/>the<sp/>dir<sp/>of<sp/>the<sp/>build<sp/>file</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1101"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>that<sp/>included<sp/>them,<sp/>so<sp/>we<sp/>have<sp/>to<sp/>undo<sp/>that<sp/>and<sp/>then<sp/>make<sp/>them<sp/>relative</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1102"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>to<sp/>the<sp/>root<sp/>dir.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1103"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>relative_include_file<sp/>=<sp/><ref refid="namespacegyp_1_1common_1a8533ebdd9774c22ee7f7450c54239796" kindref="member">gyp.common.RelativePath</ref>(</highlight></codeline>
<codeline lineno="1104"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespacegyp_1_1common_1a44c828a533e5ef5b8d9435f02d37bb0e" kindref="member">gyp.common.UnrelativePath</ref>(included_file,<sp/>build_file),</highlight></codeline>
<codeline lineno="1105"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>options.toplevel_dir,</highlight></codeline>
<codeline lineno="1106"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>)</highlight></codeline>
<codeline lineno="1107"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>abs_include_file<sp/>=<sp/>os.path.abspath(relative_include_file)</highlight></codeline>
<codeline lineno="1108"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>If<sp/>the<sp/>include<sp/>file<sp/>is<sp/>from<sp/>the<sp/>~/.gyp<sp/>dir,<sp/>we<sp/>should<sp/>use<sp/>absolute<sp/>path</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1109"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>so<sp/>that<sp/>relocating<sp/>the<sp/>src<sp/>dir<sp/>doesn&apos;t<sp/>break<sp/>the<sp/>path.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1110"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>params[</highlight><highlight class="stringliteral">&quot;home_dot_gyp&quot;</highlight><highlight class="normal">]<sp/></highlight><highlight class="keywordflow">and</highlight><highlight class="normal"><sp/>abs_include_file.startswith(</highlight></codeline>
<codeline lineno="1111"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>params[</highlight><highlight class="stringliteral">&quot;home_dot_gyp&quot;</highlight><highlight class="normal">]</highlight></codeline>
<codeline lineno="1112"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>):</highlight></codeline>
<codeline lineno="1113"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>build_files.add(abs_include_file)</highlight></codeline>
<codeline lineno="1114"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="1115"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>build_files.add(relative_include_file)</highlight></codeline>
<codeline lineno="1116"><highlight class="normal"></highlight></codeline>
<codeline lineno="1117"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>base_path,<sp/>output_file<sp/>=<sp/>CalculateMakefilePath(</highlight></codeline>
<codeline lineno="1118"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>build_file,<sp/>target<sp/>+<sp/></highlight><highlight class="stringliteral">&quot;.&quot;</highlight><highlight class="normal"><sp/>+<sp/>toolset<sp/>+<sp/>options.suffix<sp/>+<sp/></highlight><highlight class="stringliteral">&quot;.mk&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1119"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>)</highlight></codeline>
<codeline lineno="1120"><highlight class="normal"></highlight></codeline>
<codeline lineno="1121"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>spec<sp/>=<sp/>target_dicts[qualified_target]</highlight></codeline>
<codeline lineno="1122"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>configs<sp/>=<sp/>spec[</highlight><highlight class="stringliteral">&quot;configurations&quot;</highlight><highlight class="normal">]</highlight></codeline>
<codeline lineno="1123"><highlight class="normal"></highlight></codeline>
<codeline lineno="1124"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>part_of_all<sp/>=<sp/>qualified_target<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>needed_targets</highlight></codeline>
<codeline lineno="1125"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>limit_to_target_all<sp/></highlight><highlight class="keywordflow">and</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>part_of_all:</highlight></codeline>
<codeline lineno="1126"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1127"><highlight class="normal"></highlight></codeline>
<codeline lineno="1128"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>relative_target<sp/>=<sp/><ref refid="namespacegyp_1_1common_1a24688c0cf90537af3efa42115befe64b" kindref="member">gyp.common.QualifiedTarget</ref>(</highlight></codeline>
<codeline lineno="1129"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>relative_build_file,<sp/>target,<sp/>toolset</highlight></codeline>
<codeline lineno="1130"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>)</highlight></codeline>
<codeline lineno="1131"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>writer<sp/>=<sp/><ref refid="classgyp_1_1generator_1_1android_1_1_android_mk_writer" kindref="compound">AndroidMkWriter</ref>(android_top_dir)</highlight></codeline>
<codeline lineno="1132"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>android_module<sp/>=<sp/>writer.Write(</highlight></codeline>
<codeline lineno="1133"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>qualified_target,</highlight></codeline>
<codeline lineno="1134"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>relative_target,</highlight></codeline>
<codeline lineno="1135"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>base_path,</highlight></codeline>
<codeline lineno="1136"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>output_file,</highlight></codeline>
<codeline lineno="1137"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>spec,</highlight></codeline>
<codeline lineno="1138"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>configs,</highlight></codeline>
<codeline lineno="1139"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>part_of_all=part_of_all,</highlight></codeline>
<codeline lineno="1140"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>write_alias_target=write_alias_targets,</highlight></codeline>
<codeline lineno="1141"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sdk_version=sdk_version,</highlight></codeline>
<codeline lineno="1142"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>)</highlight></codeline>
<codeline lineno="1143"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>android_module<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>android_modules:</highlight></codeline>
<codeline lineno="1144"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>print(</highlight></codeline>
<codeline lineno="1145"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;ERROR:<sp/>Android<sp/>module<sp/>names<sp/>must<sp/>be<sp/>unique.<sp/>The<sp/>following<sp/>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1146"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;targets<sp/>both<sp/>generate<sp/>Android<sp/>module<sp/>name<sp/>%s.\n<sp/><sp/>%s\n<sp/><sp/>%s&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1147"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>%<sp/>(android_module,<sp/>android_modules[android_module],<sp/>qualified_target)</highlight></codeline>
<codeline lineno="1148"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>)</highlight></codeline>
<codeline lineno="1149"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1150"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>android_modules[android_module]<sp/>=<sp/>qualified_target</highlight></codeline>
<codeline lineno="1151"><highlight class="normal"></highlight></codeline>
<codeline lineno="1152"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>Our<sp/>root_makefile<sp/>lives<sp/>at<sp/>the<sp/>source<sp/>root.<sp/><sp/>Compute<sp/>the<sp/>relative<sp/>path</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1153"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>from<sp/>there<sp/>to<sp/>the<sp/>output_file<sp/>for<sp/>including.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1154"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>mkfile_rel_path<sp/>=<sp/><ref refid="namespacegyp_1_1common_1a8533ebdd9774c22ee7f7450c54239796" kindref="member">gyp.common.RelativePath</ref>(</highlight></codeline>
<codeline lineno="1155"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>output_file,<sp/>os.path.dirname(makefile_path)</highlight></codeline>
<codeline lineno="1156"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>)</highlight></codeline>
<codeline lineno="1157"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>include_list.add(mkfile_rel_path)</highlight></codeline>
<codeline lineno="1158"><highlight class="normal"></highlight></codeline>
<codeline lineno="1159"><highlight class="normal"><sp/><sp/><sp/><sp/>root_makefile.write(</highlight><highlight class="stringliteral">&quot;GYP_CONFIGURATION<sp/>?=<sp/>%s\n&quot;</highlight><highlight class="normal"><sp/>%<sp/>default_configuration)</highlight></codeline>
<codeline lineno="1160"><highlight class="normal"><sp/><sp/><sp/><sp/>root_makefile.write(</highlight><highlight class="stringliteral">&quot;GYP_VAR_PREFIX<sp/>?=\n&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1161"><highlight class="normal"><sp/><sp/><sp/><sp/>root_makefile.write(</highlight><highlight class="stringliteral">&quot;GYP_HOST_VAR_PREFIX<sp/>?=\n&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1162"><highlight class="normal"><sp/><sp/><sp/><sp/>root_makefile.write(</highlight><highlight class="stringliteral">&quot;GYP_HOST_MULTILIB<sp/>?=<sp/>first\n&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1163"><highlight class="normal"></highlight></codeline>
<codeline lineno="1164"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>Write<sp/>out<sp/>the<sp/>sorted<sp/>list<sp/>of<sp/>includes.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1165"><highlight class="normal"><sp/><sp/><sp/><sp/>root_makefile.write(</highlight><highlight class="stringliteral">&quot;\n&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1166"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>include_file<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>sorted(include_list):</highlight></codeline>
<codeline lineno="1167"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>root_makefile.write(</highlight><highlight class="stringliteral">&quot;include<sp/>$(LOCAL_PATH)/&quot;</highlight><highlight class="normal"><sp/>+<sp/>include_file<sp/>+<sp/></highlight><highlight class="stringliteral">&quot;\n&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1168"><highlight class="normal"><sp/><sp/><sp/><sp/>root_makefile.write(</highlight><highlight class="stringliteral">&quot;\n&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1169"><highlight class="normal"></highlight></codeline>
<codeline lineno="1170"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>write_alias_targets:</highlight></codeline>
<codeline lineno="1171"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>root_makefile.write(ALL_MODULES_FOOTER)</highlight></codeline>
<codeline lineno="1172"><highlight class="normal"></highlight></codeline>
<codeline lineno="1173"><highlight class="normal"><sp/><sp/><sp/><sp/>root_makefile.close()</highlight></codeline>
    </programlisting>
    <location file="backend/node_modules/node-gyp/gyp/pylib/gyp/generator/android.py"/>
  </compounddef>
</doxygen>
