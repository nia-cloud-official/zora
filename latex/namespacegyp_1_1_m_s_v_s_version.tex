\doxysection{gyp.\+MSVSVersion Namespace Reference}
\hypertarget{namespacegyp_1_1_m_s_v_s_version}{}\label{namespacegyp_1_1_m_s_v_s_version}\index{gyp.MSVSVersion@{gyp.MSVSVersion}}
\doxysubsubsection*{Classes}
\begin{DoxyCompactItemize}
\item 
class \mbox{\hyperlink{classgyp_1_1_m_s_v_s_version_1_1_visual_studio_version}{Visual\+Studio\+Version}}
\end{DoxyCompactItemize}
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{namespacegyp_1_1_m_s_v_s_version_ae26635557e5d3eb02b1914a2d783a065}{Join\+Path}} (\texorpdfstring{$\ast$}{*}args)
\item 
\mbox{\hyperlink{namespacegyp_1_1_m_s_v_s_version_ac3f33838ffca948ac40debc554a8caa5}{\+\_\+\+Registry\+Query\+Base}} (sysdir, key, value)
\item 
\mbox{\hyperlink{namespacegyp_1_1_m_s_v_s_version_aca1b498db5a5123fcfa0937a1639d21a}{\+\_\+\+Registry\+Query}} (key, value=None)
\item 
\mbox{\hyperlink{namespacegyp_1_1_m_s_v_s_version_ad58082d412a5bdd191e04ce3ebddfa36}{\+\_\+\+Registry\+Get\+Value\+Using\+Win\+Reg}} (key, value)
\item 
\mbox{\hyperlink{namespacegyp_1_1_m_s_v_s_version_a44ffb963a5ef391a6fed6c1094df9bda}{\+\_\+\+Registry\+Get\+Value}} (key, value)
\item 
\mbox{\hyperlink{namespacegyp_1_1_m_s_v_s_version_a4544149f3ecb3e480c5461146e7df933}{\+\_\+\+Create\+Version}} (name, path, sdk\+\_\+based=False)
\item 
\mbox{\hyperlink{namespacegyp_1_1_m_s_v_s_version_a66d8b94088491f668c13cf25ffd3ba8e}{\+\_\+\+Convert\+To\+Cygpath}} (path)
\item 
\mbox{\hyperlink{namespacegyp_1_1_m_s_v_s_version_ae02498e5108c16af8e7bce6fdcf2a304}{\+\_\+\+Detect\+Visual\+Studio\+Versions}} (versions\+\_\+to\+\_\+check, force\+\_\+express)
\item 
\mbox{\hyperlink{namespacegyp_1_1_m_s_v_s_version_a95c14e6e7acdaec0cbc73f5e701dad5d}{Select\+Visual\+Studio\+Version}} (version="{}auto"{}, allow\+\_\+fallback=True)
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
\begin{DoxyVerb}Handle version information related to Visual Stuio.\end{DoxyVerb}
 

\doxysubsection{Function Documentation}
\Hypertarget{namespacegyp_1_1_m_s_v_s_version_a66d8b94088491f668c13cf25ffd3ba8e}\index{gyp.MSVSVersion@{gyp.MSVSVersion}!\_ConvertToCygpath@{\_ConvertToCygpath}}
\index{\_ConvertToCygpath@{\_ConvertToCygpath}!gyp.MSVSVersion@{gyp.MSVSVersion}}
\doxysubsubsection{\texorpdfstring{\_ConvertToCygpath()}{\_ConvertToCygpath()}}
{\footnotesize\ttfamily \label{namespacegyp_1_1_m_s_v_s_version_a66d8b94088491f668c13cf25ffd3ba8e} 
gyp.\+MSVSVersion.\+\_\+\+Convert\+To\+Cygpath (\begin{DoxyParamCaption}\item[{}]{path}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}

\begin{DoxyVerb}Convert to cygwin path if we are using cygwin.\end{DoxyVerb}
 

Definition at line \mbox{\hyperlink{_m_s_v_s_version_8py_source_l00427}{427}} of file \mbox{\hyperlink{_m_s_v_s_version_8py_source}{MSVSVersion.\+py}}.

Here is the caller graph for this function\+:
% FIG 0
\Hypertarget{namespacegyp_1_1_m_s_v_s_version_a4544149f3ecb3e480c5461146e7df933}\index{gyp.MSVSVersion@{gyp.MSVSVersion}!\_CreateVersion@{\_CreateVersion}}
\index{\_CreateVersion@{\_CreateVersion}!gyp.MSVSVersion@{gyp.MSVSVersion}}
\doxysubsubsection{\texorpdfstring{\_CreateVersion()}{\_CreateVersion()}}
{\footnotesize\ttfamily \label{namespacegyp_1_1_m_s_v_s_version_a4544149f3ecb3e480c5461146e7df933} 
gyp.\+MSVSVersion.\+\_\+\+Create\+Version (\begin{DoxyParamCaption}\item[{}]{name}{, }\item[{}]{path}{, }\item[{}]{sdk\+\_\+based}{ = {\ttfamily False}}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}

\begin{DoxyVerb}Sets up MSVS project generation.

Setup is based off the GYP_MSVS_VERSION environment variable or whatever is
autodetected if GYP_MSVS_VERSION is not explicitly specified. If a version is
passed in that doesn't match a value in versions python will throw a error.
\end{DoxyVerb}
 

Definition at line \mbox{\hyperlink{_m_s_v_s_version_8py_source_l00262}{262}} of file \mbox{\hyperlink{_m_s_v_s_version_8py_source}{MSVSVersion.\+py}}.

Here is the caller graph for this function\+:
% FIG 1
\Hypertarget{namespacegyp_1_1_m_s_v_s_version_ae02498e5108c16af8e7bce6fdcf2a304}\index{gyp.MSVSVersion@{gyp.MSVSVersion}!\_DetectVisualStudioVersions@{\_DetectVisualStudioVersions}}
\index{\_DetectVisualStudioVersions@{\_DetectVisualStudioVersions}!gyp.MSVSVersion@{gyp.MSVSVersion}}
\doxysubsubsection{\texorpdfstring{\_DetectVisualStudioVersions()}{\_DetectVisualStudioVersions()}}
{\footnotesize\ttfamily \label{namespacegyp_1_1_m_s_v_s_version_ae02498e5108c16af8e7bce6fdcf2a304} 
gyp.\+MSVSVersion.\+\_\+\+Detect\+Visual\+Studio\+Versions (\begin{DoxyParamCaption}\item[{}]{versions\+\_\+to\+\_\+check}{, }\item[{}]{force\+\_\+express}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}

\begin{DoxyVerb}Collect the list of installed visual studio versions.

Returns:
A list of visual studio versions installed in descending order of
usage preference.
Base this on the registry and a quick check if devenv.exe exists.
Possibilities are:
  2005(e) - Visual Studio 2005 (8)
  2008(e) - Visual Studio 2008 (9)
  2010(e) - Visual Studio 2010 (10)
  2012(e) - Visual Studio 2012 (11)
  2013(e) - Visual Studio 2013 (12)
  2015    - Visual Studio 2015 (14)
  2017    - Visual Studio 2017 (15)
  2019    - Visual Studio 2019 (16)
  2022    - Visual Studio 2022 (17)
Where (e) is e for express editions of MSVS and blank otherwise.
\end{DoxyVerb}
 

Definition at line \mbox{\hyperlink{_m_s_v_s_version_8py_source_l00435}{435}} of file \mbox{\hyperlink{_m_s_v_s_version_8py_source}{MSVSVersion.\+py}}.

Here is the call graph for this function\+:
% FIG 2
Here is the caller graph for this function\+:
% FIG 3
\Hypertarget{namespacegyp_1_1_m_s_v_s_version_a44ffb963a5ef391a6fed6c1094df9bda}\index{gyp.MSVSVersion@{gyp.MSVSVersion}!\_RegistryGetValue@{\_RegistryGetValue}}
\index{\_RegistryGetValue@{\_RegistryGetValue}!gyp.MSVSVersion@{gyp.MSVSVersion}}
\doxysubsubsection{\texorpdfstring{\_RegistryGetValue()}{\_RegistryGetValue()}}
{\footnotesize\ttfamily \label{namespacegyp_1_1_m_s_v_s_version_a44ffb963a5ef391a6fed6c1094df9bda} 
gyp.\+MSVSVersion.\+\_\+\+Registry\+Get\+Value (\begin{DoxyParamCaption}\item[{}]{key}{, }\item[{}]{value}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}

\begin{DoxyVerb}Use _winreg or reg.exe to obtain the value of a registry key.

Using _winreg is preferable because it solves an issue on some corporate
environments where access to reg.exe is locked down. However, we still need
to fallback to reg.exe for the case where the _winreg module is not available
(for example in cygwin python).

Args:
key: The registry key.
value: The particular registry value to read.
Return:
contents of the registry key's value, or None on failure.
\end{DoxyVerb}
 

Definition at line \mbox{\hyperlink{_m_s_v_s_version_8py_source_l00232}{232}} of file \mbox{\hyperlink{_m_s_v_s_version_8py_source}{MSVSVersion.\+py}}.

Here is the call graph for this function\+:
% FIG 4
Here is the caller graph for this function\+:
% FIG 5
\Hypertarget{namespacegyp_1_1_m_s_v_s_version_ad58082d412a5bdd191e04ce3ebddfa36}\index{gyp.MSVSVersion@{gyp.MSVSVersion}!\_RegistryGetValueUsingWinReg@{\_RegistryGetValueUsingWinReg}}
\index{\_RegistryGetValueUsingWinReg@{\_RegistryGetValueUsingWinReg}!gyp.MSVSVersion@{gyp.MSVSVersion}}
\doxysubsubsection{\texorpdfstring{\_RegistryGetValueUsingWinReg()}{\_RegistryGetValueUsingWinReg()}}
{\footnotesize\ttfamily \label{namespacegyp_1_1_m_s_v_s_version_ad58082d412a5bdd191e04ce3ebddfa36} 
gyp.\+MSVSVersion.\+\_\+\+Registry\+Get\+Value\+Using\+Win\+Reg (\begin{DoxyParamCaption}\item[{}]{key}{, }\item[{}]{value}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}

\begin{DoxyVerb}Use the _winreg module to obtain the value of a registry key.

Args:
key: The registry key.
value: The particular registry value to read.
Return:
contents of the registry key's value, or None on failure.  Throws
ImportError if winreg is unavailable.
\end{DoxyVerb}
 

Definition at line \mbox{\hyperlink{_m_s_v_s_version_8py_source_l00212}{212}} of file \mbox{\hyperlink{_m_s_v_s_version_8py_source}{MSVSVersion.\+py}}.

Here is the caller graph for this function\+:
% FIG 6
\Hypertarget{namespacegyp_1_1_m_s_v_s_version_aca1b498db5a5123fcfa0937a1639d21a}\index{gyp.MSVSVersion@{gyp.MSVSVersion}!\_RegistryQuery@{\_RegistryQuery}}
\index{\_RegistryQuery@{\_RegistryQuery}!gyp.MSVSVersion@{gyp.MSVSVersion}}
\doxysubsubsection{\texorpdfstring{\_RegistryQuery()}{\_RegistryQuery()}}
{\footnotesize\ttfamily \label{namespacegyp_1_1_m_s_v_s_version_aca1b498db5a5123fcfa0937a1639d21a} 
gyp.\+MSVSVersion.\+\_\+\+Registry\+Query (\begin{DoxyParamCaption}\item[{}]{key}{, }\item[{}]{value}{ = {\ttfamily None}}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}

\begin{DoxyVerb}Use reg.exe to read a particular key through _RegistryQueryBase.

First tries to launch from %WinDir%\Sysnative to avoid WoW64 redirection. If
that fails, it falls back to System32.  Sysnative is available on Vista and
up and available on Windows Server 2003 and XP through KB patch 942589. Note
that Sysnative will always fail if using 64-bit python due to it being a
virtual directory and System32 will work correctly in the first place.

KB 942589 - http://support.microsoft.com/kb/942589/en-us.

Arguments:
key: The registry key.
value: The particular registry value to read (optional).
Return:
stdout from reg.exe, or None for failure.
\end{DoxyVerb}
 

Definition at line \mbox{\hyperlink{_m_s_v_s_version_8py_source_l00184}{184}} of file \mbox{\hyperlink{_m_s_v_s_version_8py_source}{MSVSVersion.\+py}}.

Here is the call graph for this function\+:
% FIG 7
Here is the caller graph for this function\+:
% FIG 8
\Hypertarget{namespacegyp_1_1_m_s_v_s_version_ac3f33838ffca948ac40debc554a8caa5}\index{gyp.MSVSVersion@{gyp.MSVSVersion}!\_RegistryQueryBase@{\_RegistryQueryBase}}
\index{\_RegistryQueryBase@{\_RegistryQueryBase}!gyp.MSVSVersion@{gyp.MSVSVersion}}
\doxysubsubsection{\texorpdfstring{\_RegistryQueryBase()}{\_RegistryQueryBase()}}
{\footnotesize\ttfamily \label{namespacegyp_1_1_m_s_v_s_version_ac3f33838ffca948ac40debc554a8caa5} 
gyp.\+MSVSVersion.\+\_\+\+Registry\+Query\+Base (\begin{DoxyParamCaption}\item[{}]{sysdir}{, }\item[{}]{key}{, }\item[{}]{value}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}

\begin{DoxyVerb}Use reg.exe to read a particular key.

While ideally we might use the win32 module, we would like gyp to be
python neutral, so for instance cygwin python lacks this module.

Arguments:
sysdir: The system subdirectory to attempt to launch reg.exe from.
key: The registry key to read from.
value: The particular value to read.
Return:
stdout from reg.exe, or None for failure.
\end{DoxyVerb}
 

Definition at line \mbox{\hyperlink{_m_s_v_s_version_8py_source_l00154}{154}} of file \mbox{\hyperlink{_m_s_v_s_version_8py_source}{MSVSVersion.\+py}}.

Here is the caller graph for this function\+:
% FIG 9
\Hypertarget{namespacegyp_1_1_m_s_v_s_version_ae26635557e5d3eb02b1914a2d783a065}\index{gyp.MSVSVersion@{gyp.MSVSVersion}!JoinPath@{JoinPath}}
\index{JoinPath@{JoinPath}!gyp.MSVSVersion@{gyp.MSVSVersion}}
\doxysubsubsection{\texorpdfstring{JoinPath()}{JoinPath()}}
{\footnotesize\ttfamily \label{namespacegyp_1_1_m_s_v_s_version_ae26635557e5d3eb02b1914a2d783a065} 
gyp.\+MSVSVersion.\+Join\+Path (\begin{DoxyParamCaption}\item[{\texorpdfstring{$\ast$}{*}}]{args}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{_m_s_v_s_version_8py_source_l00015}{15}} of file \mbox{\hyperlink{_m_s_v_s_version_8py_source}{MSVSVersion.\+py}}.

Here is the caller graph for this function\+:
% FIG 10
\Hypertarget{namespacegyp_1_1_m_s_v_s_version_a95c14e6e7acdaec0cbc73f5e701dad5d}\index{gyp.MSVSVersion@{gyp.MSVSVersion}!SelectVisualStudioVersion@{SelectVisualStudioVersion}}
\index{SelectVisualStudioVersion@{SelectVisualStudioVersion}!gyp.MSVSVersion@{gyp.MSVSVersion}}
\doxysubsubsection{\texorpdfstring{SelectVisualStudioVersion()}{SelectVisualStudioVersion()}}
{\footnotesize\ttfamily \label{namespacegyp_1_1_m_s_v_s_version_a95c14e6e7acdaec0cbc73f5e701dad5d} 
gyp.\+MSVSVersion.\+Select\+Visual\+Studio\+Version (\begin{DoxyParamCaption}\item[{}]{version}{ = {\ttfamily "{}auto"{}}, }\item[{}]{allow\+\_\+fallback}{ = {\ttfamily True}}\end{DoxyParamCaption})}

\begin{DoxyVerb}Select which version of Visual Studio projects to generate.

Arguments:
version: Hook to allow caller to force a particular version (vs auto).
Returns:
An object representing a visual studio project format version.
\end{DoxyVerb}
 

Definition at line \mbox{\hyperlink{_m_s_v_s_version_8py_source_l00527}{527}} of file \mbox{\hyperlink{_m_s_v_s_version_8py_source}{MSVSVersion.\+py}}.

Here is the call graph for this function\+:
% FIG 11
Here is the caller graph for this function\+:
% FIG 12
