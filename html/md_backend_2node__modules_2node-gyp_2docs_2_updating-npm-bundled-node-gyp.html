<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.11.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>My Project: Updating the npm-bundled version of node-gyp</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">My Project
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.11.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('md_backend_2node__modules_2node-gyp_2docs_2_updating-npm-bundled-node-gyp.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Updating the npm-bundled version of node-gyp</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="autotoc_md2398"></a> <a href="https://github.com/nodejs/node-gyp/labels/ERR%21%20node-gyp%20-v%20%3C%3D%20v5.1.0">Many issues</a> are opened by users who are not running a <a href="https://github.com/nodejs/node-gyp/releases">current version of node-gyp</a>.</p>
<p><code>npm</code> bundles its own, internal, copy of <code>node-gyp</code>. This internal copy is independent of any globally installed copy of node-gyp that may have been installed via <code>npm install -g node-gyp</code>.</p>
<p>Generally, npm's library files are installed inside your global "node_modules", where npm is installed (run <code>npm prefix</code> and add <code>lib/node_modules</code>, or just <code>node_modules</code> for Windows). There are some exceptions to this. Inside this global <code>node_modules/</code> there will be an <code>npm/</code> directory and inside this you'll find a <code>node_modules/node-gyp/</code> directory. So it may look something like <code>/usr/local/lib/node_modules/npm/node_modules/node-gyp/</code>. This is the version of node-gyp that ships with npm.</p>
<p>When you install a <em>new</em> version of node-gyp outside of npm, it'll go into your global node_modules, but not under the <code>npm/node_modules</code>. So that may look like <code>/usr/local/lib/node_modules/node-gyp/</code>. It'll have the <code>node-gyp</code> executable linked into your <code>PATH</code> so running <code>node-gyp</code> will use this version.</p>
<p>The catch is that npm won't use this version unless you tell it to, it'll keep on using the one you have installed. You need to instruct it to by setting the <code>node_gyp</code> config variable (which goes into your <code>~/.npmrc</code>). You do this by running the <code>npm config set</code> command as below. Then npm will use the command in the path you supply whenever it needs to build a native addon.</p>
<p><b>Important</b>: You also need to remember to unset this when you upgrade npm with a newer version of node-gyp, or you have to manually keep your globally installed node-gyp to date. See "Undo" below.</p>
<h1><a class="anchor" id="autotoc_md2399"></a>
Linux and macOS</h1>
<div class="fragment"><div class="line">npm install --global node-gyp@latest</div>
<div class="line">npm config set node_gyp $(npm prefix -g)/lib/node_modules/node-gyp/bin/node-gyp.js</div>
</div><!-- fragment --><p><code>sudo</code> may be required for the first command if you get a permission error.</p>
<h1><a class="anchor" id="autotoc_md2400"></a>
Windows</h1>
<h2><a class="anchor" id="autotoc_md2401"></a>
Windows Command Prompt</h2>
<div class="fragment"><div class="line">npm install --global node-gyp@latest</div>
<div class="line">for /f &quot;delims=&quot; %P in (&#39;npm prefix -g&#39;) do npm config set node_gyp &quot;%P\node_modules\node-gyp\bin\node-gyp.js&quot;</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md2402"></a>
Powershell</h2>
<div class="fragment"><div class="line">npm install --global node-gyp@latest</div>
<div class="line">npm prefix -g | % {npm config set node_gyp &quot;$_\node_modules\node-gyp\bin\node-gyp.js&quot;}</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md2403"></a>
Undo</h1>
<p><b>Beware</b> if you don't unset the <code>node_gyp</code> config option, npm will continue to use the globally installed version of node-gyp rather than the one it ships with, which may end up being newer.</p>
<div class="fragment"><div class="line">npm config delete node_gyp</div>
<div class="line">npm uninstall --global node-gyp</div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.11.0 </li>
  </ul>
</div>
</body>
</html>
