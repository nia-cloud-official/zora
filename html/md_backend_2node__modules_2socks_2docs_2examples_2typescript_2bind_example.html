<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.11.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>My Project: socks examples</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">My Project
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.11.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('md_backend_2node__modules_2socks_2docs_2examples_2typescript_2bind_example.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">socks examples</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="autotoc_md3540"></a> </p>
<h1><a class="anchor" id="autotoc_md3541"></a>
Example for SOCKS 'bind' command</h1>
<p>The bind command tells the SOCKS proxy server to bind and listen on a new TCP port for an incoming connection. It communicates the newly opened port back to the origin client. Once a incoming connection is accepted by the SOCKS proxy server it then communicates the remote host that connected to the SOCKS proxy back through the same initial connection via the origin client.</p>
<p>This can be used for things such as FTP clients which require incoming TCP connections, etc.</p>
<p><b>Connection Steps</b></p>
<ol type="1">
<li>Client -(bind)-&gt; Proxy (Tells the proxy to bind to a new port)</li>
<li>Client &lt;-(port)- Proxy (Tells the origin client which port it opened)</li>
<li>Client2 --&gt; Proxy (Other client connects to the proxy on this port)</li>
<li>Client &lt;&ndash;(client2's host info) (Proxy tells the origin client who connected to it)</li>
<li>Original connection to the proxy is now a full TCP stream between client (you) and client2.</li>
<li>Client &lt;--&gt; Proxy &lt;--&gt; Client2</li>
</ol>
<h1><a class="anchor" id="autotoc_md3542"></a>
Usage</h1>
<p>The 'bind' command can only be used by creating a new SocksClient instance and listening for 'bound' and 'established' events.</p>
<div class="fragment"><div class="line">import { SocksClient, SocksClientOptions } from &#39;socks&#39;;</div>
<div class="line"> </div>
<div class="line">const options: SocksClientOptions = {</div>
<div class="line">  proxy: {</div>
<div class="line">    host: &#39;104.131.124.203&#39;,</div>
<div class="line">    port: 1081,</div>
<div class="line">    type: 5</div>
<div class="line">  },</div>
<div class="line"> </div>
<div class="line">  // This should be the ip and port of the expected client that will connect to the SOCKS proxy server on the newly bound port.</div>
<div class="line">  // Most SOCKS servers accept 0.0.0.0 as a wildcard address to accept any client.</div>
<div class="line">  destination: {</div>
<div class="line">    host: &#39;0.0.0.0&#39;,</div>
<div class="line">    port: 0</div>
<div class="line">  },</div>
<div class="line"> </div>
<div class="line">  command: &#39;bind&#39;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line">const client = new SocksClient(options);</div>
<div class="line"> </div>
<div class="line">// This event is fired when the SOCKS server has started listening on a new port for incoming connections.</div>
<div class="line">client.on(&#39;bound&#39;, (info) =&gt; {</div>
<div class="line">  console.log(info);</div>
<div class="line">  /*</div>
<div class="line">  {</div>
<div class="line">    socket: &lt;Socket ...&gt;,</div>
<div class="line">    remoteHost: { // This is the remote ip and port of the SOCKS proxy that is now accepting incoming connections.</div>
<div class="line">      host: &#39;104.131.124.203&#39;,</div>
<div class="line">      port: 49928</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line">  */</div>
<div class="line">});</div>
<div class="line"> </div>
<div class="line">// This event is fired when the SOCKS server has accepted an incoming connection on the newly bound port.</div>
<div class="line">client.on(&#39;established&#39;, (info) =&gt; {</div>
<div class="line">  console.log(info);</div>
<div class="line">  /*</div>
<div class="line">  {</div>
<div class="line">    socket: &lt;Socket ...&gt;,</div>
<div class="line">    remoteHost: { // This is the remote ip and port that connected to the SOCKS proxy on the newly bound port.</div>
<div class="line">      host: &#39;1.2.3.4&#39;,</div>
<div class="line">      port: 58232</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line">  */</div>
<div class="line"> </div>
<div class="line">  // At this point info.socket is a regular net.Socket TCP connection between client and client2 (1.2.3.4) (the client which connected to the proxy on the newly bound port.)</div>
<div class="line"> </div>
<div class="line">  console.log(info.socket);</div>
<div class="line">  // &lt;Socket ...&gt;  (this is a raw net.Socket that is established to the destination host through the given proxy servers)</div>
<div class="line">});</div>
<div class="line"> </div>
<div class="line">// SOCKS proxy failed to bind.</div>
<div class="line">client.on(&#39;error&#39;, () =&gt; {</div>
<div class="line">  // Handle errors</div>
<div class="line">});</div>
<div class="line"> </div>
<div class="line">// Start connection</div>
<div class="line">client.connect();</div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.11.0 </li>
  </ul>
</div>
</body>
</html>
